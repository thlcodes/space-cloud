{"version":3,"sources":["assets/rabbit.png","components/security-rules/shortcuts-drawer/ShortcutsDrawer.jsx","components/security-rules/documentation-button/DocumentationButton.jsx","components/security-rules/configure-rule/ConfigureRule.jsx","components/security-rules/security-rules-graph/SecurityRulesGraph.jsx","components/security-rules/graph-editor/generateGraph.js","components/security-rules/graph-editor/GraphEditor.jsx","components/security-rules/json-editor/JSONEditor.jsx","operations/securityRuleBuilder.js","pages/security-rules/RulesEditor.jsx","components/form-item-label/FormItemLabel.jsx","components/db-selector/DbSelector.jsx","components/select-project/SelectProject.jsx","components/topbar/Topbar.jsx","components/conditional-form-block/ConditionalFormBlock.jsx","operations/cache.js","components/json-code-mirror/JSONCodeMirror.jsx","assets/logo-black.svg","components/object-autocomplete/ObjectAutoComplete.jsx","assets/githubIcon.svg","graphql.js","components/ant-code-mirror/AntCodeMirror.jsx","assets/heartIcon.svg","assets/githubOctocat.svg","assets/twitterIcon.svg","assets/crown.svg"],"names":["Keyboard","props","style","backgroundColor","padding","children","ShortcutsDrawer","onClose","title","placement","visible","width","className","gutter","span","DocumentationButton","onClick","window","open","LinkOutlined","Option","AlertMsgApplyTransformations","href","color","getInputValueFromActualValue","value","dataType","undefined","JSON","stringify","String","createValueAndTypeValidator","type","arrayAllowed","_","cb","includes","split","map","v","trim","every","isNaN","error","parseValue","parseNumber","parseBoolean","parse","Number","isTypeOfFieldsString","fields","rules","ConfigureRule","useForm","form","useState","col","setCol","selectedRule","rule","f1","f2","field","url","store","outputFormat","claims","requestTemplate","db","cache","dbConfigs","useSelector","state","getDbConfigs","dbList","Object","keys","selectedDb","setSelectedDb","data","getTrackedCollections","collectionSchemaString","getCollectionSchema","ruleMetaData","group","id","autoCompleteOptions","ruleType","securityRuleGroups","DB_COLLECTIONS","schemaAST","generateSchemaAST","schemaFields","reduce","prev","curr","assign","name","selectedNodeId","args","op","auth","token","doc","find","update","$set","$inc","$mul","$min","$max","$currentDate","$currentTimestamp","FILESTORE","REMOTE_SERVICES","EVENTING","DB_PREPARED_QUERIES","params","EVENTING_FILTERS","INGRESS_ROUTES","query","path","pathArray","headers","inheritedDataType","getTypeFromValue","formInitialValues","eval","loadVar","singleInputFields","multipleInputFields","length","applyTransformations","errorMsg","cacheResponse","cacheTTL","ttl","cacheInstantInvalidate","instantInvalidate","closeDrawer","onFinish","values","parseArray","ex","notify","toString","template","clauses","clause","onSubmit","initialValues","validateMessages","required","FormItemLabel","Item","placeholder","filter","val","blockDepth","key","ConditionalFormBlock","dependency","condition","getFieldValue","shouldUpdate","noStyle","validator","ObjectAutoComplete","options","description","showIcon","marginBottom","valuePropName","List","add","remove","index","validateTrigger","CloseOutlined","margin","PlusOutlined","onChange","setFieldsValue","isJson","JSONCodeMirror","hint","message","AntCodeMirror","border","mode","lineNumbers","styleActiveLine","matchBrackets","autoCloseBrackets","tabSize","onSearch","toLowerCase","indexOf","isCachingEnabled","checked","float","marginRight","htmlType","groups","no_rule","background","highlight","root","borderWidth","shapeProperties","borderDashes","borderRadius","add_rule","nodes","shape","font","size","widthConstraint","maximum","edges","arrows","to","enabled","arrowStrikethrough","physics","smooth","forceDirection","layout","hierarchical","parentCentralization","sortMethod","direction","nodeSpacing","levelSeparation","interaction","dragNodes","height","SecurityRulesGraph","graph","events","getNetwork","network","setNetwork","mergeGraph","graph1","graph2","convertRuleToGraph","parentId","isRootBlock","push","label","from","forEach","len","generateGraph","ruleName","create","dbCreateGraph","read","dbReadGraph","dbUpdateGraph","delete","dbDeleteGraph","fileCreateGraph","fileReadGraph","fileDeleteGraph","rootRuleGraph","LOCAL_STORAGE_RULE_KEY","getStrippedKey","ruleKey","replace","GraphEditor","setRule","setselectedNodeId","doubleClickedNodeId","setDoubleClickedNodeId","useEffect","handleResize","redraw","fit","addEventListener","removeEventListener","doubleClickedRuleObj","dotProp","get","getDoubleClickedRuleObject","oncontext","event","position","pointer","DOM","nodeId","getNodeAt","selectNodes","select","node","doubleClick","startsWith","shortcutsHandler","strippedKey","selectedRuleObj","saveObjectToLocalStorage","getObjectFromLocalStorage","then","copiedRule","set","catch","noOfClauses","menu","Fragment","overlay","trigger","handleKeys","onKeyEvent","localStorage","getItem","closable","right","bottom","afterClose","setItem","JSONEditor","json","autofocus","gutters","lint","onBeforeChange","editor","saveSecurityRule","projectId","Promise","resolve","reject","req","saveColSecurityRules","savePreparedQuerySecurityRule","saveFileStoreSecurityRule","saveEventingSecurityRule","saveEventingTriggerRule","saveRemoteServiceEndpointRule","saveIngressRouteRule","queued","bc","BroadcastChannel","meta","postMessage","RulesEditor","projectID","useParams","location","useLocation","qs","search","ignoreQueryPrefix","getCollectionSecurityRule","getPreparedQuerySecurityRule","getFileStoreSecurityRule","getEventingSecurityRule","getEventingTriggerFilterRules","getRemoteEndpointSecurityRule","getIngressRouteSecurityRule","getIngressRouteURL","getSecurityRuleInfo","initialRule","tab","cacheConfig","getCacheConfig","shortcutsDrawer","openShortcutsDrawer","initialRuleStringified","stringifiedRule","setStringifiedRule","activeTab","setActiveTab","ruleExists","rulesChanged","defaultRulesPossible","useDeepCompareEffect","incrementPendingRequests","ruleId","promises","loadDbConfig","loadDbSchemas","loadCacheConfig","loadDbRules","loadDbPreparedQueries","loadEventingSecurityRules","loadEventingTriggers","loadFileStoreRules","loadRemoteServices","loadIngressRoutes","all","loadSecurityRules","finally","decrementPendingRequests","onSaveChanges","opener","closed","focus","close","handleUseDefaultRules","actionQueuedMessage","UseDefaultRulesButton","disabled","Topbar","defaultActiveKey","activeKey","parsedRule","TabPane","display","flexDirection","justifyContent","block","marginTop","obj","src","rabbit","alt","defaultDBRules","defaultPreparedQueryRule","defaultEventRule","defaultEventFilterRule","defaultFileRule","defaultEndpointRule","defaultIngressRoutingRule","extra","fontSize","DbSelector","selectedDB","history","useHistory","entries","alias","setSvgIcon","dbIcons","dbcolumns","dataIndex","render","record","CheckOutlined","onCell","selected","text","footer","bodyStyle","onCancel","handleCancel","pagination","columns","dataSource","onRow","cursor","handleSelect","SelectProject","projects","widtht","openProject","modalVisible","setModalVisible","setVisible","selectedProject","isClusterUpgraded","project","projectName","svgIcon","content","fontWeight","align","md","offset","target","githubOctocat","twitterIcon","MenuOutlined","dispatch","logo","upLogo","showProjectSelector","CaretDownOutlined","showDbSelector","dbName","setLastUsedValues","githubIcon","overlayStyle","textAlign","heartIcon","isProdMode","PoweroffOutlined","verticalAlign","removeItem","redirectToLogin","saveCacheConfig","config","client","setCacheConfig","loadCacheConnState","result","getCacheConnStatus","setCacheConnState","purgeCache","resource","dbAlias","getCacheConnState","connected","setValue","handleChangeValue","module","exports","filteredOptions","variables","slice","join","getFilteredOptions","onSelect","substring","lastIndexOf","lorem","LoremIpsum","primitiveTypes","getDefType","isArray","kind","fieldType","schemaString","gql","definitions","def","directives","isPrimary","some","dir","isLink","hasForeignConstraint","hasUniqueConstraint","hasNestedFields","hasCreatedAtDirective","hasUpdatedAtDirective","foreignTable","foreignField","foreignDirective","tableArgument","arguments","ar","fieldArgument","linkTable","linkFrom","linkTo","linkDb","linkDirective","fromArgument","toArgument","dbArgument","isRequired","foreign","table","link","generateSchemaASTFromGraphQLSchemaDefinition","generateGraphQLArgsString","argsKeyValuePairs","arg","generateFieldQuery","directivesString","fieldString","removeRegex","dataresponse","format","generateGraphQLQueryFromGraphQLAST","ast","queryType","gqlPrettier","generateSchemaASTs","schemas","dbSchema","generateRandomValue","generateId","generateWords","Math","ceil","random","toFixed","Date","toISOString","foo","generateRandomFieldValues","generateWhereClause","primaryFields","getPrimaryOrUniqueFields","_contains","_eq","getSchemaAST","schemaASTs","schemaName","generateSampleQueryDBDelete","dbAliasName","applyFilters","whereClause","res","graphQLRequestAST","response","status","getInsertFields","parentSchemaName","getAutoGeneratedFields","schemasTraversed","dotprop","insertableFields","adjustedDbName","finalFields","generateSampleQueryDBInsert","fieldsToBeInserted","insertedFields","docs","insertedFieldValues","returning","getReadFields","generateSampleQueryDBRead","sort","skip","limit","sortWeight","ID","Integer","Float","Time","DateTime","sortFields","a","b","selectionSet","selectionSetValue","generateSampleQueryDBUpdate","upsert","setFields","I"],"mappings":"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","file":"static/js/10.fbae210a.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/rabbit.55524419.png\";","import React from \"react\";\nimport { Drawer, Row, Col } from \"antd\";\nimport \"./shortcuts-drawer.css\"\n\nfunction Keyboard(props) {\n  return (\n    <span style={{ backgroundColor: '#D9D9D9', padding: '5px 10px' }}>\n      {props.children}\n    </span>\n  );\n};\n\nfunction ShortcutsDrawer({ onClose }) {\n  return (\n    <Drawer\n      title='Shortcuts'\n      placement='right'\n      onClose={onClose}\n      visible={true}\n      width={720}\n    >\n      <Row className=\"shortcuts-row\" gutter={16}>\n        <Col span={6}>\n          <span className=\"shortcuts-keys-holder\">\n            <Keyboard>Ctrl</Keyboard> + <Keyboard>C</Keyboard>\n          </span>\n        </Col>\n        <Col span={16}>Copy the selected rule</Col>\n      </Row>\n      <Row className=\"shortcuts-row\" gutter={16}>\n        <Col span={6}>\n          <span className=\"shortcuts-keys-holder\">\n            <Keyboard>Ctrl</Keyboard> + <Keyboard>X</Keyboard>\n          </span>\n        </Col>\n        <Col span={16}>Cut along with children</Col>\n      </Row>\n      <Row className=\"shortcuts-row\" gutter={16}>\n        <Col span={6}>\n          <span className=\"shortcuts-keys-holder\">\n            <Keyboard>Ctrl</Keyboard> + <Keyboard>Alt</Keyboard> +<Keyboard>C</Keyboard>\n          </span>\n        </Col>\n        <Col span={16}>Copy the selected rule and its children</Col>\n      </Row>\n      <Row className=\"shortcuts-row\" gutter={16}>\n        <Col span={6}>\n          <span className=\"shortcuts-keys-holder\">\n            <Keyboard>Ctrl</Keyboard> + <Keyboard>V</Keyboard>\n          </span>\n        </Col>\n        <Col span={16}>Paste the copied rule on any selected AND/OR rule</Col>\n      </Row>\n      <Row className=\"shortcuts-row\" gutter={16}>\n        <Col span={6}>\n          <span className=\"shortcuts-keys-holder\">\n            <Keyboard>Alt</Keyboard> + <Keyboard>R</Keyboard>\n          </span>\n        </Col>\n        <Col span={16}>Replace the selected rule with the copied rule</Col>\n      </Row>\n      <Row className=\"shortcuts-row\" gutter={16}>\n        <Col span={6}>\n          <span className=\"shortcuts-keys-holder\">\n            <Keyboard>Delete</Keyboard>\n          </span>\n        </Col>\n        <Col span={16}>Delete the selected rule</Col>\n      </Row>\n    </Drawer>\n  )\n}\n\nexport default ShortcutsDrawer","import React from \"react\";\nimport { Button } from \"antd\";\nimport { LinkOutlined } from \"@ant-design/icons\";\n\nfunction DocumentationButton() {\n  return (\n    <Button onClick={() => window.open(\"https://docs.spaceuptech.com/\")}>\n      Documentation\n      <LinkOutlined />\n    </Button>\n  )\n}\n\nexport default DocumentationButton","import React, { useState } from 'react';\nimport FormItemLabel from '../../form-item-label/FormItemLabel';\nimport {\n  Form,\n  Select,\n  Input,\n  InputNumber,\n  Alert,\n  Checkbox,\n  Drawer,\n  Button,\n  Row,\n  Col,\n  AutoComplete,\n} from 'antd';\nimport ConditionalFormBlock from '../../conditional-form-block/ConditionalFormBlock';\nimport { PlusOutlined, CloseOutlined } from '@ant-design/icons';\nimport { notify, isJson } from '../../../utils';\nimport { generateSchemaAST } from '../../../graphql';\nimport { useSelector } from 'react-redux';\nimport FormItem from 'antd/lib/form/FormItem';\nimport ObjectAutoComplete from \"../../object-autocomplete/ObjectAutoComplete\";\nimport { getCollectionSchema, getDbConfigs, getTrackedCollections } from '../../../operations/database';\nimport { securityRuleGroups } from '../../../constants';\nimport JSONCodeMirror from '../../json-code-mirror/JSONCodeMirror';\nimport AntCodeMirror from \"../../ant-code-mirror/AntCodeMirror\";\n\nconst { Option } = Select;\n\nfunction AlertMsgApplyTransformations() {\n  return (\n    <div>\n      <b>Info</b> <br />\n      Describe the transformed request body using <a href='https://golang.org/pkg/text/template/' style={{ color: '#7EC6FF' }}>\n        <b>Go templates</b>\n      </a>. Space Cloud will execute the specified template to generate the new request.\n    </div>\n  );\n}\n\nconst getInputValueFromActualValue = (value, dataType) => {\n  if (value === null || value === undefined) {\n    return \"\"\n  }\n  if (dataType === \"object\") {\n    return JSON.stringify(value, null, 2)\n  }\n  return String(value)\n}\n\nconst getTypeFromValue = (value) => {\n  if (value === \"\") {\n    return\n  }\n\n  if (typeof value === \"number\") return \"number\"\n  if (typeof value === \"boolean\") return \"bool\"\n  if (typeof value === \"string\") {\n    if (value.includes(\".\")) return \"variable\"\n    return \"string\"\n  }\n  if (typeof value === \"object\") return \"object\"\n}\n\nconst createValueAndTypeValidator = (type, arrayAllowed) => {\n  return (_, value, cb) => {\n    if (!type || value == undefined) {\n      cb()\n      return\n    }\n\n    if (type === \"string\") {\n      cb()\n      return\n    }\n\n    // Allow variables\n    if (value.includes(\".\")) {\n      cb()\n      return\n    }\n\n\n    if (!arrayAllowed && value.includes(\",\")) {\n      cb(\"Commas are not allowed here!\")\n      return\n    }\n\n    const values = value.split(\",\").map(v => v.trim())\n    const areValuesValid = values.every(v => {\n      if (v) {\n        switch (type) {\n          case \"number\":\n            return !isNaN(v)\n          case \"bool\":\n            return v === \"true\" || v === \"false\"\n          case \"variable\":\n            return v.includes(\".\")\n        }\n      } else {\n        return true\n      }\n    })\n    if (!areValuesValid) {\n      let error = \"\"\n      switch (type) {\n        case \"number\":\n          error = \"Value must be a number or a variable\"\n          break\n        case \"bool\":\n          error = \"Value must be a boolean or a variable\"\n          break\n        case \"variable\":\n          error = \"Value must be a variable\"\n          break\n      }\n      cb(error)\n      return\n    }\n    cb()\n  }\n}\n\nconst parseValue = (value, type) => {\n  switch (type) {\n    case \"number\":\n      return parseNumber(value)\n    case \"bool\":\n      return parseBoolean(value)\n    case \"object\":\n      return JSON.parse(value)\n    default:\n      return value\n  }\n}\n\nconst parseBoolean = (value) => {\n  if (value === \"true\") return true\n  if (value === \"false\") return false\n  return value\n}\n\nconst parseNumber = (value) => {\n  return !isNaN(value) ? Number(value) : value\n}\n\nconst parseArray = (value, type) => {\n  if (!value.includes(\",\")) {\n    return value\n  }\n  return value.split(\",\").map(value => value.trim()).map(value => parseValue(value, type))\n}\n\nconst isTypeOfFieldsString = (fields) => {\n  return typeof fields === \"string\"\n}\n\nconst rules = ['allow', 'deny', 'authenticated', 'match', 'and', 'or', 'query', 'webhook', 'force', 'remove', 'encrypt', 'decrypt', 'hash'];\n\nconst ConfigureRule = (props) => {\n  // form\n  const [form] = Form.useForm();\n\n  // Component state\n  const [col, setCol] = useState('');\n\n  // Derived properties\n  const { rule, type, f1, f2, error, fields, field, value, url, store, outputFormat, claims, requestTemplate, db, cache } = props.selectedRule;\n  const dbConfigs = useSelector(state => getDbConfigs(state))\n  const dbList = Object.keys(dbConfigs)\n  const [selectedDb, setSelectedDb] = useState(db);\n  const data = useSelector(state => getTrackedCollections(state, selectedDb))\n  const collectionSchemaString = useSelector(state => getCollectionSchema(state, props.ruleMetaData.group, props.ruleMetaData.id))\n\n  // Handlers\n  const handleSelectDatabase = (value) => setSelectedDb(value);\n  const handleSearch = (value) => setCol(value);\n\n  const onFinish = (values) => {\n    // Parse values\n    switch (values.rule) {\n      case \"match\":\n        if (values.eval === 'in' || values.eval === 'notIn') {\n          values.f2 = parseArray(values.f2, values.type)\n        } else {\n          values.f1 = parseValue(values.f1, values.type)\n          values.f2 = parseValue(values.f2, values.type)\n        }\n        break;\n      case \"force\":\n        values.value = parseValue(values.value, values.type)\n        delete values[\"type\"]\n        break;\n      case \"query\":\n        try {\n          values.find = JSON.parse(values.find);\n        } catch (ex) {\n          notify(\"error\", \"Error\", ex.toString())\n          return;\n        }\n        if (values.cacheResponse) {\n          values.cache = {\n            ttl: values.cacheTTL,\n            instantInvalidate: values.cacheInstantInvalidate ? true : false\n          }\n        }\n        delete values[\"cacheResponse\"]\n        delete values[\"cacheTTL\"]\n        delete values[\"cacheInstantInvalidate\"]\n        break;\n      case \"webhook\":\n        if (values[\"applyTransformations\"]) {\n          values.template = \"go\"\n        }\n\n        delete values[\"applyTransformations\"]\n        break;\n    }\n\n    delete values.errorMsg;\n\n    if (values.rule === \"and\" || values.rule === \"or\") {\n      if (!props.selectedRule.clauses) values.clauses = [];\n      else values.clauses = props.selectedRule.clauses\n    }\n    if (values.rule === \"query\" || values.rule === \"webhook\" || values.rule === \"force\" || values.rule === \"remove\" || values.rule === \"encrypt\" || values.rule === \"decrypt\" || values.rule === \"hash\") {\n      values.clause = props.selectedRule.clause\n      values.fields = values.loadVar ? values.singleInputFields : values.multipleInputFields\n      delete values[\"loadVar\"]\n      delete values[\"singleInputFields\"]\n      delete values[\"multipleInputFields\"]\n    }\n\n    props.onSubmit(values);\n    props.closeDrawer();\n  };\n\n  // Autocomplete options\n  let autoCompleteOptions = {};\n\n  switch (props.ruleMetaData.ruleType) {\n    case securityRuleGroups.DB_COLLECTIONS:\n      const schemaAST = generateSchemaAST(collectionSchemaString);\n      const colSchemaFields = schemaAST[props.ruleMetaData.id] ? schemaAST[props.ruleMetaData.id] : []\n      const schemaFields = colSchemaFields.reduce((prev, curr) => Object.assign({}, prev, { [curr.name]: true }), {})\n      switch (props.selectedNodeId) {\n        case \"create\":\n          autoCompleteOptions = { args: { op: true, auth: true, token: true, doc: schemaFields } }\n          break;\n        case \"read\":\n          autoCompleteOptions = { args: { op: true, auth: true, token: true, find: schemaFields } }\n          break;\n        case \"update\":\n          const update = {\n            $set: schemaFields,\n            $inc: schemaFields,\n            $mul: schemaFields,\n            $min: schemaFields,\n            $max: schemaFields,\n            $currentDate: schemaFields,\n            $currentTimestamp: schemaFields\n          }\n          autoCompleteOptions = { args: { op: true, auth: true, token: true, find: schemaFields, update } }\n          break;\n        case \"delete\":\n          autoCompleteOptions = { args: { op: true, auth: true, token: true, find: schemaFields } }\n          break\n      }\n      break;\n    case securityRuleGroups.FILESTORE:\n    case securityRuleGroups.REMOTE_SERVICES:\n    case securityRuleGroups.EVENTING:\n    case securityRuleGroups.DB_PREPARED_QUERIES:\n      autoCompleteOptions = { args: { auth: true, params: true, token: true } }\n      break;\n    case securityRuleGroups.EVENTING_FILTERS:\n      autoCompleteOptions = { args: { data: true } }\n      break;\n    case securityRuleGroups.INGRESS_ROUTES:\n      const query = {\n        path: true,\n        pathArray: true,\n        params: true,\n        headers: true\n      }\n      autoCompleteOptions = { args: { auth: true, params: true, query, token: true } }\n  }\n\n  const inheritedDataType = getTypeFromValue(value)\n  const formInitialValues = {\n    rule,\n    type: (rule === \"force\") ? inheritedDataType : type,\n    f1: getInputValueFromActualValue(f1, type),\n    eval: props.selectedRule.eval,\n    f2: getInputValueFromActualValue(f2, type),\n    loadVar: isTypeOfFieldsString(fields),\n    singleInputFields: isTypeOfFieldsString(fields) ? fields : \"\",\n    multipleInputFields: isTypeOfFieldsString(fields) ? undefined : (fields && fields.length ? fields : [\"\"]),\n    fields,\n    field,\n    value: getInputValueFromActualValue(value, inheritedDataType),\n    url,\n    store,\n    claims: claims ? claims : \"\",\n    applyTransformations: requestTemplate || claims ? true : false,\n    outputFormat: outputFormat ? outputFormat : \"yaml\",\n    requestTemplate: requestTemplate ? requestTemplate : \"\",\n    db: db,\n    col: props.selectedRule.col,\n    find: JSON.stringify(props.selectedRule.find, null, 2),\n    errorMsg: error ? true : false,\n    error,\n    cacheResponse: cache ? true : false,\n    cacheTTL: cache && cache.ttl !== undefined && cache.ttl !== null ? cache.ttl : undefined,\n    cacheInstantInvalidate: cache && cache.instantInvalidate !== undefined && cache.instantInvalidate !== null ? cache.instantInvalidate : undefined\n  }\n\n  if (formInitialValues.type === \"object\") {\n    formInitialValues.value = JSON.stringify(formInitialValues.value, null, 2)\n  }\n\n  return (\n    <Drawer\n      title='Configure rule'\n      placement='right'\n      onClose={props.closeDrawer}\n      visible={true}\n      width={560}\n    >\n      <Form\n        name='configure'\n        form={form}\n        onFinish={onFinish}\n        initialValues={formInitialValues}\n        validateMessages={{ required: \"Please provide a value!\" }}\n      >\n        <FormItemLabel name='Rule Type' />\n        <Form.Item name='rule'>\n          <Select placeholder=\"Rule\">\n            {rules\n              .filter((val) => {\n                if (props.blockDepth === 1) return true\n                return ![\"allow\", \"deny\", \"authenticated\"].includes(val)\n              })\n              .map((val) => (\n                <Select.Option key={val} value={val}>\n                  {val}\n                </Select.Option>\n              ))}\n          </Select>\n        </Form.Item>\n        <ConditionalFormBlock\n          dependency='rule'\n          condition={() => form.getFieldValue('rule') === 'match'}\n        >\n          <FormItemLabel name='Operands data type' />\n          <Form.Item name='type' rules={[{ required: true }]}>\n            <Select placeholder=\"Data type\">\n              <Select.Option value='string'>String</Select.Option>\n              <Select.Option value='number'>Number</Select.Option>\n              <Select.Option value='bool'>Bool</Select.Option>\n            </Select>\n          </Form.Item>\n          <FormItemLabel name='First operand' />\n          <Form.Item shouldUpdate={(prev, curr) => (curr.type !== prev.type)} noStyle>\n            {\n              () => {\n                const type = form.getFieldValue(\"type\")\n                return (\n                  <Form.Item name='f1' rules={[{ required: true }, { validator: createValueAndTypeValidator(type, false) }]}>\n                    <ObjectAutoComplete placeholder=\"First operand\" options={autoCompleteOptions} />\n                  </Form.Item>\n                )\n              }\n            }\n          </Form.Item>\n          <FormItemLabel name='Evaluation type' />\n          <Form.Item name='eval' rules={[{ required: true }]}>\n            <Select placeholder=\"Evaluation\">\n              <Select.Option value='=='>Equals to</Select.Option>\n              <Select.Option value='!='>Not equals to</Select.Option>\n              <Select.Option value='>'>Greater than</Select.Option>\n              <Select.Option value='>='>Greater than equal to</Select.Option>\n              <Select.Option value='<'>Lesser than</Select.Option>\n              <Select.Option value='<='>Lesser than equal to</Select.Option>\n              <Select.Option value='in'>In</Select.Option>\n              <Select.Option value='notIn'>Not in</Select.Option>\n            </Select>\n          </Form.Item>\n          <FormItemLabel name='Second operand' />\n          <Form.Item shouldUpdate={(prev, curr) => (curr.type !== prev.type)} noStyle>\n            {\n              () => {\n                const type = form.getFieldValue(\"type\")\n                return (\n                  <Form.Item name='f2' rules={[{ required: true }, { validator: createValueAndTypeValidator(type, true) }]}>\n                    <ObjectAutoComplete placeholder=\"Second operand\" options={autoCompleteOptions} />\n                  </Form.Item>\n                )\n              }\n            }\n          </Form.Item>\n          <Alert\n            description={\n              <div>\n                You can use variables and helper functions inside operands\n              </div>\n            }\n            type='info'\n            showIcon\n            style={{ marginBottom: 24 }}\n          />\n        </ConditionalFormBlock>\n        <ConditionalFormBlock\n          dependency='rule'\n          condition={() =>\n            form.getFieldValue('rule') === 'encrypt' ||\n            form.getFieldValue('rule') === 'decrypt' ||\n            form.getFieldValue('rule') === \"remove\" ||\n            form.getFieldValue('rule') === \"hash\"\n          }\n        >\n          <FormItemLabel name='Fields' />\n          <Form.Item name=\"loadVar\" valuePropName=\"checked\">\n            <Checkbox>\n              Load fields from a variable\n            </Checkbox>\n          </Form.Item>\n          <ConditionalFormBlock dependency='loadVar' condition={() => form.getFieldValue('loadVar')}>\n            <Row>\n              <Col span={14}>\n                <Form.Item name=\"singleInputFields\">\n                  <Input placeholder=\"Variable to load fields from\" />\n                </Form.Item>\n              </Col>\n            </Row>\n          </ConditionalFormBlock>\n          <ConditionalFormBlock dependency='loadVar' condition={() => !form.getFieldValue('loadVar')}>\n            <Form.List name='multipleInputFields'>\n              {(fields, { add, remove }) => {\n                return (\n                  <>\n                    {fields.map((field, index) => (\n                      <Row key={field.key}>\n                        <Col span={14}>\n                          <Form.Item\n                            name={[field.name]}\n                            key={[field.name]}\n                            rules={[\n                              { required: true },\n                              { validator: createValueAndTypeValidator(\"variable\", false), validateTrigger: \"onBlur\" }\n                            ]}\n                          >\n                            <ObjectAutoComplete placeholder=\"Field\" options={autoCompleteOptions} />\n                          </Form.Item>\n                        </Col>\n                        <Col span={2}>\n                          <CloseOutlined\n                            style={{ margin: '0 8px' }}\n                            onClick={() => {\n                              remove(field.name);\n                            }}\n                          />\n                        </Col>\n                      </Row>\n                    ))}\n                    <Form.Item>\n                      <Button\n                        type='dashed'\n                        onClick={() => {\n                          add();\n                        }}\n                        style={{ width: '40%' }}\n                      >\n                        <PlusOutlined /> Add field\n                    </Button>\n                    </Form.Item>\n                  </>\n                );\n              }}\n            </Form.List>\n          </ConditionalFormBlock>\n          <Alert\n            description={<div>You can use variables inside fields</div>}\n            type='info'\n            showIcon\n            style={{ marginBottom: 24 }}\n          />\n        </ConditionalFormBlock>\n        <ConditionalFormBlock\n          dependency=\"rule\"\n          condition={() => form.getFieldValue('rule') === 'force'}\n        >\n          <FormItemLabel name=\"Field\" />\n          <FormItem name=\"field\" rules={[{ required: true }, { validator: createValueAndTypeValidator(\"variable\", false), validateTrigger: \"onBlur\" }]}>\n            <ObjectAutoComplete placeholder=\"Field\" options={autoCompleteOptions} />\n          </FormItem>\n          <FormItemLabel name=\"Datatype\" />\n          <FormItem name=\"type\" rules={[{ required: true }]}>\n            <Select placeholder=\"Data type\">\n              <Select.Option value=\"string\">String</Select.Option>\n              <Select.Option value=\"number\">Number</Select.Option>\n              <Select.Option value=\"bool\">Bool</Select.Option>\n              <Select.Option value=\"object\">Object</Select.Option>\n              <Select.Option value=\"variable\">Variable</Select.Option>\n            </Select>\n          </FormItem>\n          <FormItemLabel name=\"Value\" />\n          <ConditionalFormBlock\n            dependency=\"type\"\n            condition={() => form.getFieldValue('type') !== 'object'}>\n            <Form.Item shouldUpdate={(prev, curr) => (curr.type !== prev.type)} noStyle>\n              {\n                () => {\n                  const type = form.getFieldValue(\"type\")\n                  return (\n                    <Form.Item name='value' rules={[{ required: true }, { validator: createValueAndTypeValidator(type, false) }]}>\n                      <ObjectAutoComplete placeholder=\"Value\" options={autoCompleteOptions} onChange={(value) => {\n                        if (value.includes(\".\") && type !== \"variable\") {\n                          form.setFieldsValue({ type: \"variable\" })\n                        }\n                      }} />\n                    </Form.Item>\n                  )\n                }\n              }\n            </Form.Item>\n          </ConditionalFormBlock>\n          <ConditionalFormBlock\n            dependency=\"type\"\n            condition={() => form.getFieldValue('type') === 'object'}>\n            <Form.Item shouldUpdate={(prev, curr) => (curr.type !== prev.type)} noStyle>\n              {\n                () => {\n                  const type = form.getFieldValue(\"type\")\n                  return (\n                    <Form.Item name='value' rules={[{ required: true }, {\n                      validateTrigger: \"onBlur\",\n                      validator: (_, value, cb) => {\n                        if (value && !isJson(value)) {\n                          cb(\"Please provide a valid JSON object!\")\n                          return\n                        }\n                        cb()\n                      }\n                    }]}>\n                      <JSONCodeMirror />\n                    </Form.Item>\n                  )\n                }\n              }\n            </Form.Item>\n          </ConditionalFormBlock>\n        </ConditionalFormBlock>\n        <ConditionalFormBlock\n          dependency=\"rule\"\n          condition={() => form.getFieldValue('rule') === \"webhook\"} >\n          <FormItemLabel name=\"URL\" />\n          <FormItem name=\"url\" rules={[{ required: true }]}>\n            <Input placeholder=\"URL\" />\n          </FormItem>\n          <FormItemLabel name=\"Store\" hint=\"(Optional)\" />\n          <FormItem name=\"store\" rules={[{ required: false }]}>\n            <Input placeholder=\"The variable to store the webhook response. For example: args.res\" />\n          </FormItem>\n          <FormItemLabel name='Apply transformations' />\n          <Form.Item name='applyTransformations' valuePropName='checked'>\n            <Checkbox>\n              Transform the webhook request body using templates\n          </Checkbox>\n          </Form.Item>\n          <ConditionalFormBlock\n            dependency='applyTransformations'\n            condition={() => form.getFieldValue('applyTransformations') === true}\n          >\n            <Alert\n              message={<AlertMsgApplyTransformations />}\n              type='info'\n              showIcon\n              style={{ marginBottom: 21 }}\n            />\n            <FormItemLabel name=\"Template output format\" description=\"Format for parsing the template output\" />\n            <Form.Item name=\"outputFormat\">\n              <Select style={{ width: 96 }}>\n                <Option value='yaml'>YAML</Option>\n                <Option value='json'>JSON</Option>\n              </Select>\n            </Form.Item>\n            <FormItemLabel name=\"JWT claims template\" hint=\"(Optional)\" description=\"Template to generate the transformed claims of the webhook request\" />\n            <Form.Item name=\"claims\">\n              <AntCodeMirror style={{ border: \"1px solid #D9D9D9\" }} options={{\n                mode: { name: 'go' },\n                lineNumbers: true,\n                styleActiveLine: true,\n                matchBrackets: true,\n                autoCloseBrackets: true,\n                tabSize: 2\n              }} />\n            </Form.Item>\n            <FormItemLabel name=\"Request template\" hint=\"(Optional)\" description=\"Template to generate the transformed request body\" />\n            <Form.Item name='requestTemplate' >\n              <AntCodeMirror style={{ border: \"1px solid #D9D9D9\" }} options={{\n                mode: { name: 'go' },\n                lineNumbers: true,\n                styleActiveLine: true,\n                matchBrackets: true,\n                autoCloseBrackets: true,\n                tabSize: 2\n              }} />\n            </Form.Item>\n          </ConditionalFormBlock>\n        </ConditionalFormBlock>\n        <ConditionalFormBlock\n          dependency='rule'\n          condition={() => form.getFieldValue('rule') === 'query'}\n        >\n          <FormItemLabel name='Database' />\n          <Form.Item\n            name='db'\n            rules={[{ required: true }]}\n          >\n            <AutoComplete\n              placeholder='Select a database'\n              onChange={handleSelectDatabase}\n              options={dbList.map(db => ({ value: db }))}\n            />\n          </Form.Item>\n          <FormItemLabel name='Collection / Table name' />\n          <Form.Item name='col' rules={[{ required: true }]}>\n            <AutoComplete\n              placeholder='Collection / Table name'\n              onSearch={handleSearch}\n            >\n              {data\n                .filter(\n                  (data) =>\n                    data.toLowerCase().indexOf(col.toLowerCase()) !== -1\n                )\n                .map((data) => (\n                  <AutoComplete.Option key={data} value={data}>\n                    {data}\n                  </AutoComplete.Option>\n                ))}\n            </AutoComplete>\n          </Form.Item>\n          <FormItemLabel name='Find query' style={{ border: '1px solid #D9D9D9' }} />\n          <Form.Item name=\"find\" rules={[{ required: true }, {\n            validateTrigger: \"onBlur\",\n            validator: (_, value, cb) => {\n              if (value && !isJson(value)) {\n                cb(\"Please provide a valid JSON object!\")\n                return\n              }\n              cb()\n            }\n          }]}>\n            <JSONCodeMirror />\n          </Form.Item>\n          <FormItemLabel name=\"Store\" hint=\"(Optional)\" />\n          <FormItem name=\"store\" rules={[{ required: false }]}>\n            <Input placeholder=\"The variable to store the query response. For example: args.res\" />\n          </FormItem>\n          <ConditionalFormBlock\n            shouldUpdate={true}\n            condition={() => props.isCachingEnabled}>\n            <FormItemLabel name=\"Caching\" />\n            <Form.Item name='cacheResponse' valuePropName='checked'>\n              <Checkbox>\n                Cache the results\n              </Checkbox>\n            </Form.Item>\n            <ConditionalFormBlock\n              dependency='cacheResponse'\n              condition={() => form.getFieldValue('cacheResponse') === true}>\n              <FormItemLabel name=\"Cache TTL\" hint=\"(in seconds)\" />\n              <Form.Item name=\"cacheTTL\">\n                <InputNumber placeholder=\"TTL in seconds\" style={{ width: \"100%\" }} />\n              </Form.Item>\n              <FormItemLabel name=\"Cache invalidation\" />\n              <Form.Item name=\"cacheInstantInvalidate\" valuePropName='checked'>\n                <Checkbox>\n                  Enable instant invalidation of cached results\n                </Checkbox>\n              </Form.Item>\n            </ConditionalFormBlock>\n          </ConditionalFormBlock>\n        </ConditionalFormBlock>\n        <FormItemLabel name='Customize error message' />\n        <Form.Item name='errorMsg' valuePropName='checked'>\n          <Checkbox checked={error ? true : false}>\n            Customize the error message sent to client if the rule fails\n          </Checkbox>\n        </Form.Item>\n        <ConditionalFormBlock\n          dependency='errorMsg'\n          condition={() => form.getFieldValue('errorMsg') === true}\n        >\n          <FormItemLabel name='Error message' />\n          <Form.Item name='error' rules={[{ required: true }]}>\n            <Input placeholder=\"Error message\" />\n          </Form.Item>\n        </ConditionalFormBlock>\n        <span style={{ float: 'right' }}>\n          <Button style={{ marginRight: 16 }} onClick={() => props.closeDrawer()}>Cancel</Button>\n          <Button type='primary' htmlType='submit'>\n            Save\n          </Button>\n        </span>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default ConfigureRule;\n","import React from \"react\";\nimport Graph from 'react-graph-vis';\nimport \"./security-rules-graph.css\";\n\nconst options = {\n  groups: {\n    no_rule: {\n      color: {\n        border: '#d0d0d0',\n        background: '#eaeaea',\n        highlight: {\n          border: '#c0c0c0',\n          background: '#eaeaea'\n        }\n      },\n    },\n    root: {\n      borderWidth: 1,\n      color: {\n        border: \"#53a415\",\n        background: \"#b7eb8f\",\n        highlight: {\n          border: \"#6c944e\",\n          background: \"#b7eb8f\"\n        }\n      },\n    },\n    rule: {\n      borderWidth: 1,\n      color: {\n        border: '#1e8bce',\n        background: '#91d5ff',\n        highlight: {\n          border: \"#036bab\",\n          background: '#91d5ff',\n        }\n      },\n      shapeProperties: {\n        borderDashes: false,\n        borderRadius: 0,\n      },\n    },\n    add_rule: {\n      borderWidth: 2,\n      color: {\n        border: 'rgba(0, 0, 0, 0.37)',\n        background: \"#fff\",\n        highlight: {\n          border: 'rgba(0, 0, 0, 0.45)',\n          background: \"#fff\",\n        }\n      },\n      shapeProperties: {\n        borderDashes: [2, 4],\n        borderRadius: 4,\n      },\n    },\n  },\n  nodes: {\n    shape: 'box',\n    shapeProperties: {\n      borderRadius: 0,\n    },\n    color: {\n      border: '#F0F0F0',\n      background: 'white'\n    },\n    font: {\n      size: 16,\n    },\n    margin: 16,\n    widthConstraint: {\n      maximum: 150\n    }\n  },\n  edges: {\n    arrows: {\n      to: {\n        enabled: false,\n      },\n    },\n    color: '#000000',\n    arrowStrikethrough: true,\n    physics: false,\n    smooth: {\n      enabled: true,\n      type: \"cubicBezier\",\n      forceDirection: \"horizontal\"\n    }\n  },\n  layout: {\n    hierarchical: {\n      enabled: true,\n      parentCentralization: false,\n      sortMethod: 'directed',\n      direction: 'LR',\n      nodeSpacing: 120,\n      levelSeparation: 200\n    },\n  },\n  interaction: {\n    dragNodes: false,\n  },\n  physics: false,\n  height: \"100%\"\n};\n\nconst SecurityRulesGraph = props => {\n  return (\n    <Graph\n      graph={props.graph}\n      options={options}\n      events={props.events}\n      getNetwork={(network) => {\n        props.setNetwork(network);\n      }}\n    />\n  )\n}\n\nexport default SecurityRulesGraph\n","import { securityRuleGroups } from \"../../../constants\"\nconst { DB_COLLECTIONS, FILESTORE } = securityRuleGroups\n\nconst mergeGraph = (graph1, graph2) => {\n  const nodes = [...graph1.nodes, ...graph2.nodes]\n  const edges = [...graph1.edges, ...graph2.edges]\n  return { nodes, edges }\n}\n\nconst convertRuleToGraph = (rule, id, parentId) => {\n  let graph = { nodes: [], edges: [] }\n\n  const isRootBlock = !parentId.includes(\".\")\n  if (!rule || !rule.rule) {\n    if (isRootBlock) {\n      // Add a block to add rule\n      graph.nodes.push({ id: id, label: \"+ Add rule\", group: \"add_rule\" })\n      graph.edges.push({ from: parentId, to: id })\n    }\n    return graph\n  }\n\n  graph.nodes.push({ id: id, label: rule.rule, group: \"rule\" })\n  graph.edges.push({ from: parentId, to: id })\n\n  if (rule.rule === \"and\" || rule.rule === \"or\") {\n    if (rule.clauses) {\n      rule.clauses.forEach((clause, index) => {\n        graph = mergeGraph(graph, convertRuleToGraph(clause, `${id}.clauses.${index}`, id))\n      })\n    }\n    const len = rule.clauses ? rule.clauses.length : 0\n    graph.nodes.push({ id: `${id}.clauses.${len}`, label: \"+ Add clause\", group: \"add_rule\" })\n    graph.edges.push({ from: id, to: `${id}.clauses.${len}` })\n  }\n  if (rule.rule === \"query\" || rule.rule === \"force\" || rule.rule === \"remove\" || rule.rule === \"encrypt\" || rule.rule === \"decrypt\" || rule.rule === \"hash\") {\n    if (rule.clause && rule.clause.rule) {\n      graph = mergeGraph(graph, convertRuleToGraph(rule.clause, `${id}.clause`, id))\n    } else {\n      graph.nodes.push({ id: `${id}.clause`, label: \"Set clause\", group: \"add_rule\" })\n      graph.edges.push({ from: id, to: `${id}.clause` })\n    }\n  }\n  return graph\n}\n\nconst generateGraph = (ruleType, ruleName, rule) => {\n\n  const nodes = []\n  const edges = []\n\n  nodes.push({ id: \"root\", label: ruleName, group: \"root\" })\n\n  switch (ruleType) {\n    case DB_COLLECTIONS:\n      nodes.push({ id: \"root:create\", label: \"create\", group: rule.create ? \"root\" : \"no_rule\" })\n      edges.push({ from: \"root\", to: \"root:create\" })\n      const dbCreateGraph = convertRuleToGraph(rule.create, \"rule:create\", \"root:create\")\n      nodes.push(...dbCreateGraph.nodes)\n      edges.push(...dbCreateGraph.edges)\n\n      nodes.push({ id: \"root:read\", label: \"read\", group: rule.read ? \"root\" : \"no_rule\" })\n      edges.push({ from: \"root\", to: \"root:read\" })\n      const dbReadGraph = convertRuleToGraph(rule.read, \"rule:read\", \"root:read\")\n      nodes.push(...dbReadGraph.nodes)\n      edges.push(...dbReadGraph.edges)\n\n      nodes.push({ id: \"root:update\", label: \"update\", group: rule.update ? \"root\" : \"no_rule\" })\n      edges.push({ from: \"root\", to: \"root:update\" })\n      const dbUpdateGraph = convertRuleToGraph(rule.update, \"rule:update\", \"root:update\")\n      nodes.push(...dbUpdateGraph.nodes)\n      edges.push(...dbUpdateGraph.edges)\n\n      nodes.push({ id: \"root:delete\", label: \"delete\", group: rule.delete ? \"root\" : \"no_rule\" })\n      edges.push({ from: \"root\", to: \"root:delete\" })\n      const dbDeleteGraph = convertRuleToGraph(rule.delete, \"rule:delete\", \"root:delete\")\n      nodes.push(...dbDeleteGraph.nodes)\n      edges.push(...dbDeleteGraph.edges)\n      break\n\n    case FILESTORE:\n      nodes.push({ id: \"root:create\", label: \"create\", group: rule.create ? \"root\" : \"no_rule\" })\n      edges.push({ from: \"root\", to: \"root:create\" })\n      const fileCreateGraph = convertRuleToGraph(rule.create, \"rule:create\", \"root:create\")\n      nodes.push(...fileCreateGraph.nodes)\n      edges.push(...fileCreateGraph.edges)\n\n      nodes.push({ id: \"root:read\", label: \"read\", group: rule.read ? \"root\" : \"no_rule\" })\n      edges.push({ from: \"root\", to: \"root:read\" })\n      const fileReadGraph = convertRuleToGraph(rule.read, \"rule:read\", \"root:read\")\n      nodes.push(...fileReadGraph.nodes)\n      edges.push(...fileReadGraph.edges)\n\n      nodes.push({ id: \"root:delete\", label: \"delete\", group: rule.delete ? \"root\" : \"no_rule\" })\n      edges.push({ from: \"root\", to: \"root:delete\" })\n      const fileDeleteGraph = convertRuleToGraph(rule.delete, \"rule:delete\", \"root:delete\")\n      nodes.push(...fileDeleteGraph.nodes)\n      edges.push(...fileDeleteGraph.edges)\n      break\n\n    default:\n      const rootRuleGraph = convertRuleToGraph(rule, \"rule:root\", \"root\")\n      nodes.push(...rootRuleGraph.nodes)\n      edges.push(...rootRuleGraph.edges)\n  }\n\n  return { nodes, edges };\n}\n\nexport default generateGraph\n","import React, { useState, useEffect } from \"react\";\nimport { Menu, Dropdown, Alert, message } from \"antd\"\nimport dotProp from 'dot-prop-immutable';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport ConfigureRule from '../configure-rule/ConfigureRule';\nimport SecurityRulesGraph from \"../security-rules-graph/SecurityRulesGraph\";\nimport { saveObjectToLocalStorage, getObjectFromLocalStorage } from \"../../../utils\";\nimport generateGraph from \"./generateGraph\";\n\nconst LOCAL_STORAGE_RULE_KEY = \"securityRuleBuilder:copiedRule\"\n\nconst getStrippedKey = (ruleKey) => ruleKey.replace(\"rule:\", \"\").replace(\"root:\", \"\").replace(\"root.\", \"\")\n\nconst getDoubleClickedRuleObject = (rule, ruleKey) => {\n  if (ruleKey === \"rule:root\") {\n    return rule\n  }\n\n  return dotProp.get(rule, getStrippedKey(ruleKey), {})\n}\n\nfunction GraphEditor({ rule, setRule, ruleName, ruleMetaData, isCachingEnabled }) {\n  const { ruleType } = ruleMetaData\n\n  // Component state\n  const [selectedNodeId, setselectedNodeId] = useState();\n  const [doubleClickedNodeId, setDoubleClickedNodeId] = useState(\"\");\n  const [network, setNetwork] = useState();\n\n  useEffect(() => {\n    function handleResize() {\n      if (network) {\n        network.redraw()\n        network.fit()\n      }\n    }\n    window.addEventListener('resize', handleResize)\n    return () => window.removeEventListener('resize', handleResize)\n  }, [network])\n\n  // Derived state\n  const graph = generateGraph(ruleType, ruleName, rule)\n  const doubleClickedRuleObj = doubleClickedNodeId ? getDoubleClickedRuleObject(rule, doubleClickedNodeId) : {} // Used in the configure rule form as initial values\n\n  // mouse events handlers\n  const events = {\n    oncontext: (event) => {\n      const position = event.pointer.DOM;\n      const nodeId = network.getNodeAt(position);\n      if (nodeId) {\n        network.selectNodes([nodeId], false);\n        const group = graph.nodes.find(val => val.id === nodeId).group;\n        if (group !== \"add_rule\") {\n          setselectedNodeId(nodeId);\n        }\n      }\n    },\n    select: (event) => {\n      const node = event.nodes[0];\n      if (!node) return;\n      const group = graph.nodes.find(val => val.id === node).group;\n      // Set double clicked node id since clicking the add rule button should open the configure rule form \n      // same as how double clicking a node opens the configure rule form.\n      if (group === \"add_rule\") {\n        setDoubleClickedNodeId(node)\n      } else {\n        setselectedNodeId(node);\n      }\n    },\n    doubleClick: function (event) {\n      const nodeId = event.nodes[0];\n      if (nodeId && nodeId.startsWith(\"root\")) {\n        message.error(\"Operation not allowed. Only rule blocks (blue ones) can be double clicked to configure them\")\n        return\n      }\n      setDoubleClickedNodeId(nodeId);\n    },\n  };\n\n  // shortcut events handler\n  const shortcutsHandler = (key) => {\n    if (!selectedNodeId) return;\n    if (selectedNodeId === \"root\") {\n      message.error(\"No operations are allowed on root block\")\n      return\n    }\n\n    const strippedKey = getStrippedKey(selectedNodeId)\n    const selectedRuleObj = Object.assign({}, strippedKey === \"root\" ? rule : dotProp.get(rule, strippedKey))\n\n    switch (key) {\n      case \"ctrl+c\":\n        if (selectedNodeId.includes(\"root:\")) {\n          message.error(\"Copy is not allowed on this block. Copy a rule block instead\")\n          return\n        }\n\n        delete selectedRuleObj[\"clause\"]\n        delete selectedRuleObj[\"clauses\"]\n        saveObjectToLocalStorage(LOCAL_STORAGE_RULE_KEY, selectedRuleObj)\n        break;\n\n      case \"ctrl+alt+c\":\n        if (selectedNodeId.includes(\"root:\")) {\n          message.error(\"Copy is not allowed on this block. Copy a rule block instead\")\n          return\n        }\n\n        saveObjectToLocalStorage(LOCAL_STORAGE_RULE_KEY, selectedRuleObj)\n        break;\n\n      case \"ctrl+x\":\n        if (strippedKey === \"root\" || selectedNodeId.includes(\"root:\")) {\n          message.error(\"Cut is not allowed on this block. Only child rule blocks can be cut\")\n          return\n        }\n\n        saveObjectToLocalStorage(LOCAL_STORAGE_RULE_KEY, selectedRuleObj)\n        setRule(dotProp.delete(rule, strippedKey))\n        break\n\n      case \"alt+r\":\n        if (selectedNodeId.includes(\"root:\")) {\n          message.error(\"Replace operation not allowed on this block. Try replacing a rule block (blue ones)\")\n          return\n        }\n\n        getObjectFromLocalStorage(LOCAL_STORAGE_RULE_KEY)\n          .then(copiedRule => {\n            if (strippedKey === \"root\") {\n              setRule(copiedRule);\n              return\n            }\n            setRule(dotProp.set(rule, strippedKey, copiedRule))\n          })\n          .catch(ex => message.error(ex.toString()))\n        break;\n\n      case \"ctrl+v\":\n        getObjectFromLocalStorage(LOCAL_STORAGE_RULE_KEY)\n          .then(copiedRule => {\n            if (selectedNodeId.includes(\"root:\")) {\n              setRule(dotProp.set(rule, strippedKey, copiedRule))\n              return\n            }\n            if (selectedRuleObj.rule === \"and\" || selectedRuleObj.rule === \"or\") {\n              const noOfClauses = selectedRuleObj.clauses ? selectedRuleObj.clauses.length : 0\n              if (strippedKey === \"root\") {\n                setRule(dotProp.set(rule, `clauses.${noOfClauses}`, copiedRule))\n              } else {\n                setRule(dotProp.set(rule, `${strippedKey}.clauses.${noOfClauses}`, copiedRule))\n              }\n              return\n            }\n            if (selectedRuleObj.rule === \"query\" || selectedRuleObj.rule === \"force\" || selectedRuleObj.rule === \"remove\" || selectedRuleObj.rule === \"encrypt\" || selectedRuleObj.rule === \"decrypt\" || selectedRuleObj.rule === \"hash\") {\n              if (strippedKey === \"root\") {\n                setRule(dotProp.set(rule, \"clause\", copiedRule))\n              } else {\n                setRule(dotProp.set(rule, `${strippedKey}.clause`, copiedRule))\n              }\n              return\n            }\n            message.error(\"Paste operation is not valid on this block.\")\n          })\n          .catch(ex => message.error(ex.toString()))\n        break\n\n      case \"del\":\n        if (strippedKey === \"root\") {\n          message.error(\"Deleting the root rule is not supported\")\n          return\n        }\n\n        setRule(dotProp.delete(rule, strippedKey))\n        break;\n    }\n  };\n\n  // On drawer form submit\n  const onSubmit = (values) => {\n    if (doubleClickedNodeId === \"rule:root\") {\n      setRule(values)\n      return\n    }\n    setRule(dotProp.set(rule, getStrippedKey(doubleClickedNodeId), values));\n  };\n\n  const menu = (\n    <Menu onClick={({ key }) => shortcutsHandler(key)}>\n      <Menu.Item key='ctrl+c'>Copy</Menu.Item>\n      <Menu.Item key='ctrl+alt+c'>Copy with children</Menu.Item>\n      <Menu.Item key='ctrl+x'>Cut</Menu.Item>\n      <Menu.Item key='ctrl+v'>Paste</Menu.Item>\n      <Menu.Item key='alt+r'>Replace</Menu.Item>\n      <Menu.Item key='del'>Delete</Menu.Item>\n    </Menu>\n  );\n\n  return (\n    <React.Fragment>\n      <Dropdown overlay={menu} trigger={['contextMenu']}>\n        <KeyboardEventHandler\n          handleKeys={[\n            'ctrl+c',\n            'ctrl+alt+c',\n            'ctrl+v',\n            'ctrl+h',\n            'del',\n            'ctrl+x',\n            'alt+r',\n          ]}\n          onKeyEvent={shortcutsHandler}\n        >\n          <SecurityRulesGraph graph={graph} events={events} setNetwork={setNetwork} />\n          {!localStorage.getItem('builderHelp:closed') && (\n            <Alert\n              description='You can double click on a rule block to configure it or right click on it for more options.'\n              type='warning'\n              closable\n              style={{\n                width: 400,\n                position: 'absolute',\n                right: 45,\n                bottom: 100,\n                background: '#F0F0F0',\n                border: '1px solid #EEEEEE',\n              }}\n              afterClose={() =>\n                localStorage.setItem('builderHelp:closed', true)\n              }\n            />\n          )}\n        </KeyboardEventHandler>\n      </Dropdown>\n      {doubleClickedNodeId && (\n        <ConfigureRule\n          selectedRule={doubleClickedRuleObj}\n          closeDrawer={() => setDoubleClickedNodeId(\"\")}\n          ruleMetaData={ruleMetaData}\n          onSubmit={onSubmit}\n          selectedNodeId={getStrippedKey(doubleClickedNodeId).split(\".\")[0]}\n          blockDepth={doubleClickedNodeId.split(\".\").length}\n          isCachingEnabled={isCachingEnabled}\n        />\n      )}\n    </React.Fragment>\n  )\n}\n\nexport default GraphEditor;","import React from \"react\";\nimport { Controlled as CodeMirror } from 'react-codemirror2';\nimport 'codemirror/theme/material.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/mode/javascript/javascript';\nimport 'codemirror/addon/selection/active-line.js';\nimport 'codemirror/addon/edit/matchbrackets.js';\nimport 'codemirror/addon/edit/closebrackets.js';\nimport 'codemirror/addon/lint/json-lint.js';\nimport 'codemirror/addon/lint/lint.js';\n\nfunction JSONEditor({ rule, setRule }) {\n\n  return (\n    <CodeMirror\n      style={{ border: '1px solid #D9D9D9' }}\n      value={rule}\n      options={{\n        mode: { name: 'javascript', json: true },\n        lineNumbers: true,\n        styleActiveLine: true,\n        matchBrackets: true,\n        autoCloseBrackets: true,\n        tabSize: 2,\n        autofocus: true,\n        gutters: [],\n        lint: true\n      }}\n      onBeforeChange={(editor, data, value) => {\n        setRule(value);\n      }}\n    />\n  )\n}\n\nexport default JSONEditor","import { loadDbConfig, loadDbSchemas, loadDbRules, loadDbPreparedQueries, getCollectionSecurityRule, getPreparedQuerySecurityRule, saveColSecurityRules, savePreparedQuerySecurityRule } from \"./database\"\nimport { securityRuleGroups } from \"../constants\"\nimport { loadEventingSecurityRules, getEventingSecurityRule, saveEventingSecurityRule, loadEventingTriggers, getEventingTriggerFilterRules, saveEventingTriggerRule } from \"./eventing\"\nimport { loadFileStoreRules, getFileStoreSecurityRule, saveFileStoreSecurityRule } from \"./fileStore\"\nimport { loadRemoteServices, getRemoteEndpointSecurityRule, saveRemoteServiceEndpointRule } from \"./remoteServices\"\nimport { loadIngressRoutes, getIngressRouteSecurityRule, getIngressRouteURL, saveIngressRouteRule } from \"./ingressRoutes\"\nimport { loadCacheConfig } from \"./cache\"\nimport { BroadcastChannel } from 'broadcast-channel';\n\nexport const loadSecurityRules = (projectId, ruleType, ruleId) => {\n  const promises = [loadDbConfig(projectId), loadDbSchemas(projectId), loadCacheConfig()]\n\n  switch (ruleType) {\n    case securityRuleGroups.DB_COLLECTIONS:\n      promises.push(loadDbRules(projectId))\n      break;\n    case securityRuleGroups.DB_PREPARED_QUERIES:\n      promises.push(loadDbPreparedQueries(projectId))\n      break;\n    case securityRuleGroups.EVENTING:\n      promises.push(loadEventingSecurityRules(projectId))\n      break;\n    case securityRuleGroups.EVENTING_FILTERS:\n      promises.push(loadEventingTriggers(projectId, ruleId))\n      break;\n    case securityRuleGroups.FILESTORE:\n      promises.push(loadFileStoreRules(projectId))\n      break;\n    case securityRuleGroups.REMOTE_SERVICES:\n      promises.push(loadRemoteServices(projectId))\n      break;\n    case securityRuleGroups.INGRESS_ROUTES:\n      promises.push(loadIngressRoutes(projectId))\n      break;\n  }\n\n  return Promise.all(promises)\n}\n\nexport const getSecurityRuleInfo = (state, ruleType, id, group) => {\n  switch (ruleType) {\n    case securityRuleGroups.DB_COLLECTIONS:\n      return { rule: getCollectionSecurityRule(state, group, id), name: id }\n    case securityRuleGroups.DB_PREPARED_QUERIES:\n      return { rule: getPreparedQuerySecurityRule(state, group, id), name: id }\n    case securityRuleGroups.FILESTORE:\n      return { rule: getFileStoreSecurityRule(state, id), name: id }\n    case securityRuleGroups.EVENTING:\n      return { rule: getEventingSecurityRule(state, id), name: id }\n    case securityRuleGroups.EVENTING_FILTERS:\n      return { rule: getEventingTriggerFilterRules(state, id), name: id }\n    case securityRuleGroups.REMOTE_SERVICES:\n      return { rule: getRemoteEndpointSecurityRule(state, group, id), name: id }\n    case securityRuleGroups.INGRESS_ROUTES:\n      const ingressSecurityRule = getIngressRouteSecurityRule(state, id)\n      const url = getIngressRouteURL(state, id)\n      return { rule: ingressSecurityRule, name: url }\n    default:\n      return { rule: {}, name: \"\" }\n  }\n}\n\nexport const saveSecurityRule = (projectId, ruleType, id, group, rule) => {\n  return new Promise((resolve, reject) => {\n    let req = {}\n    switch (ruleType) {\n      case securityRuleGroups.DB_COLLECTIONS:\n        req = saveColSecurityRules(projectId, group, id, rule)\n        break\n      case securityRuleGroups.DB_PREPARED_QUERIES:\n        req = savePreparedQuerySecurityRule(projectId, group, id, rule)\n        break\n      case securityRuleGroups.FILESTORE:\n        req = saveFileStoreSecurityRule(projectId, id, rule)\n        break\n      case securityRuleGroups.EVENTING:\n        req = saveEventingSecurityRule(projectId, id, rule)\n        break\n      case securityRuleGroups.EVENTING_FILTERS:\n        req = saveEventingTriggerRule(projectId, id, { filter: rule })\n        break\n      case securityRuleGroups.REMOTE_SERVICES:\n        req = saveRemoteServiceEndpointRule(projectId, group, id, rule)\n        break\n      case securityRuleGroups.INGRESS_ROUTES:\n        req = saveIngressRouteRule(projectId, id, rule)\n        break\n    }\n\n    req\n      .then(({ queued }) => {\n        const bc = new BroadcastChannel('security-rules');\n        const message = {\n          rule: rule,\n          projectId: projectId,\n          meta: { ruleType, id, group },\n          queued\n        }\n\n        // Notify the parent tab\n        bc.postMessage(message)\n        resolve({ queued })\n      })\n      .catch(ex => reject(ex))\n  })\n}","import React, { useState } from 'react';\nimport './rules-editor.css';\nimport Topbar from '../../components/topbar/Topbar';\nimport { Tabs, Button, Tooltip } from 'antd';\n\nimport { notify, decrementPendingRequests, incrementPendingRequests } from '../../utils';\nimport rabbit from '../../assets/rabbit.png';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport ShortcutsDrawer from \"../../components/security-rules/shortcuts-drawer/ShortcutsDrawer\"\n\nimport { useParams, useLocation } from 'react-router-dom';\nimport qs from 'qs';\nimport { useSelector } from 'react-redux';\nimport DocumentationButton from \"../../components/security-rules/documentation-button/DocumentationButton\";\nimport GraphEditor from \"../../components/security-rules/graph-editor/GraphEditor\";\nimport JSONEditor from \"../../components/security-rules/json-editor/JSONEditor\";\nimport useDeepCompareEffect from 'use-deep-compare-effect';\nimport { getSecurityRuleInfo, loadSecurityRules, saveSecurityRule } from '../../operations/securityRuleBuilder';\nimport { securityRuleGroups, defaultDBRules, defaultPreparedQueryRule, defaultEventRule, defaultFileRule, defaultEndpointRule, defaultIngressRoutingRule, actionQueuedMessage, defaultEventFilterRule } from '../../constants';\nimport { getCacheConfig } from '../../operations/cache';\n\nconst RulesEditor = () => {\n  // Router params\n  const { projectID } = useParams();\n  const location = useLocation()\n  const ruleMetaData = qs.parse(location.search, { ignoreQueryPrefix: true });\n  const { ruleType, id, group } = ruleMetaData\n\n  // Global state \n  const { rule: initialRule, name } = useSelector(state => getSecurityRuleInfo(state, ruleType, id, group))\n  const tab = localStorage.getItem('rules:editor') ? localStorage.getItem('rules:editor') : 'builder';\n  const cacheConfig = useSelector(state => getCacheConfig(state))\n\n  // Component state\n  const [shortcutsDrawer, openShortcutsDrawer] = useState(false);\n  const [rule, setRule] = useState(initialRule);\n  const initialRuleStringified = JSON.stringify(initialRule, null, 2)\n  const [stringifiedRule, setStringifiedRule] = useState(initialRuleStringified);\n  const [activeTab, setActiveTab] = useState(tab)\n\n  // Derived state\n  const ruleExists = Object.keys(rule).length > 0\n  const rulesChanged = activeTab === \"builder\" ? JSON.stringify(initialRule) !== JSON.stringify(rule) : stringifiedRule !== initialRuleStringified\n  const defaultRulesPossible = ruleType === securityRuleGroups.DB_COLLECTIONS || ruleType === securityRuleGroups.DB_PREPARED_QUERIES\n\n  useDeepCompareEffect(() => {\n    setRule(initialRule)\n  }, [initialRule])\n\n  useDeepCompareEffect(() => {\n    setStringifiedRule(JSON.stringify(rule, null, 2));\n  }, [rule]);\n\n  useDeepCompareEffect(() => {\n    if (projectID) {\n      incrementPendingRequests()\n      loadSecurityRules(projectID, ruleMetaData.ruleType, ruleMetaData.id)\n        .catch(ex => notify(\"error\", \"Error fetching rule\", ex))\n        .finally(() => decrementPendingRequests())\n    }\n  }, [projectID, ruleMetaData])\n\n  const onTabChange = (tab) => {\n    try {\n      const parsedRule = JSON.parse(stringifiedRule);\n      localStorage.setItem('rules:editor', tab);\n      setRule(parsedRule);\n      setActiveTab(tab)\n    } catch (ex) {\n      notify(\"error\", \"Error\", ex.toString());\n    }\n  };\n\n  const addDefaultSecurityRules = () => {\n    switch (ruleType) {\n      case securityRuleGroups.DB_COLLECTIONS:\n        setRule(defaultDBRules)\n        break;\n      case securityRuleGroups.DB_PREPARED_QUERIES:\n        setRule(defaultPreparedQueryRule)\n        break;\n      case securityRuleGroups.EVENTING:\n        setRule(defaultEventRule)\n        break;\n      case securityRuleGroups.EVENTING_FILTERS:\n        setRule(defaultEventFilterRule)\n        break;\n      case securityRuleGroups.FILESTORE:\n        setRule(defaultFileRule)\n        break;\n      case securityRuleGroups.REMOTE_SERVICES:\n        setRule(defaultEndpointRule)\n        break;\n      case securityRuleGroups.INGRESS_ROUTES:\n        setRule(defaultIngressRoutingRule)\n        break;\n    }\n  }\n\n  // On save rule\n  const onSaveChanges = (tab) => {\n    try {\n      incrementPendingRequests()\n      const rules = tab === \"builder\" ? rule : JSON.parse(stringifiedRule);\n      saveSecurityRule(projectID, ruleType, id, group, rules)\n        .then(() => {\n          if (window.opener && !window.opener.closed) {\n            window.opener.focus()\n            window.close()\n          }\n        })\n        .catch(ex => notify(\"error\", \"Error saving rules\", ex))\n        .finally(() => decrementPendingRequests())\n    } catch (ex) {\n      decrementPendingRequests()\n      notify(\"error\", \"Error\", ex)\n      return;\n    }\n  }\n\n  const handleUseDefaultRules = () => {\n    incrementPendingRequests()\n    saveSecurityRule(projectID, ruleType, id, group, {})\n      .then(({ queued }) => {\n        if (!queued) {\n          setRule({})\n          return\n        }\n        notify(\"success\", \"Success\", actionQueuedMessage)\n      })\n      .catch(ex => notify(\"error\", \"Error using default rules\", ex))\n      .finally(() => decrementPendingRequests())\n  }\n\n  // Prettify JSON code\n  const prettify = () => {\n    try {\n      const obj = JSON.parse(stringifiedRule);\n      setStringifiedRule(JSON.stringify(obj, null, 2));\n    } catch (ex) {\n      notify('error', 'Error', ex.toString());\n    }\n  };\n\n  const UseDefaultRulesButton = () => {\n    if (!defaultRulesPossible) {\n      return (\n        <Tooltip title=\"Default rules work only for database\" >\n          <Button style={{ marginRight: 16 }} disabled>Use default rules</Button>\n        </Tooltip>\n      )\n    }\n    return <Button onClick={handleUseDefaultRules} style={{ marginRight: 16 }}>Use default rules</Button>\n  }\n\n  return (\n    <React.Fragment>\n      <KeyboardEventHandler\n        handleKeys={['ctrl+/']}\n        onKeyEvent={(key) => openShortcutsDrawer(!shortcutsDrawer)}\n      />\n      <Topbar />\n      <div className='editor-page'>\n        {ruleExists && (\n          <Tabs defaultActiveKey={tab} activeKey={activeTab} onChange={onTabChange} style={{ height: \"100%\" }}>\n            <Tabs.TabPane tab='Builder' key='builder' >\n              <React.Fragment>\n                <div style={{ display: \"flex\", flexDirection: \"column\", height: \"100%\" }}>\n                  <div style={{ marginBottom: 16, display: \"flex\", justifyContent: \"space-between\" }}>\n                    <span><b>Rules</b> ({name})</span>\n                    <span>\n                      <UseDefaultRulesButton />\n                      <Button onClick={() => openShortcutsDrawer(true)} style={{ marginRight: 16 }}>Shortcuts</Button>\n                      <DocumentationButton />\n                    </span>\n                  </div>\n                  <div className=\"rule-editor-holder\" style={{ height: \"calc(100% - 104px)\", border: '1px solid #D9D9D9' }}>\n                    <GraphEditor rule={rule} setRule={setRule} ruleName={name} ruleMetaData={ruleMetaData} isCachingEnabled={cacheConfig.enabled} />\n                  </div>\n                  <Button type='primary' size=\"large\" onClick={() => onSaveChanges(\"builder\")} block style={{ marginTop: 16 }} disabled={!rulesChanged}>Save</Button>\n                </div>\n              </React.Fragment>\n            </Tabs.TabPane>\n            <Tabs.TabPane tab='JSON' key='JSON' >\n              <React.Fragment>\n                <div style={{ marginBottom: 16, display: \"flex\", justifyContent: \"space-between\" }}>\n                  <span><b>Rules</b> ({name})</span>\n                  <span>\n                    <UseDefaultRulesButton />\n                    <Button style={{ marginRight: 16 }} onClick={prettify}>Prettify</Button>\n                    <DocumentationButton />\n                  </span>\n                </div>\n                <div className=\"rule-editor-holder\" style={{ height: \"calc(100% - 104px)\", border: '1px solid #D9D9D9' }} >\n                  <JSONEditor rule={stringifiedRule} setRule={setStringifiedRule} />\n                </div>\n                <Button type='primary' size=\"large\" onClick={() => onSaveChanges(\"json\")} block style={{ marginTop: 16 }} disabled={!rulesChanged}>Save</Button>\n              </React.Fragment>\n            </Tabs.TabPane>\n          </Tabs>\n        )}\n        {!ruleExists && (\n          <div style={{ padding: 32 }}>\n            <div style={{ marginBottom: 24, display: \"flex\", justifyContent: \"space-between\" }}>\n              <span><b>Rules</b> ({name})</span>\n              <DocumentationButton />\n            </div>\n            <div className='rabbit'>\n              <img src={rabbit} alt='rabbit.png' />\n              <p style={{ margin: '30px 0px' }}>No rules defined yet. {defaultRulesPossible ? \"Default rules are being applied.\" : \"Define rules for the resource.\"}</p>\n              <Button onClick={addDefaultSecurityRules} type='primary' size='large'>Add rules</Button>\n            </div>\n          </div>\n        )}\n        {shortcutsDrawer && <ShortcutsDrawer onClose={() => openShortcutsDrawer(false)} />}\n      </div>\n    </React.Fragment>\n  );\n};\n\nexport default RulesEditor;","import React from \"react\"\n\nexport default function FormItemLabel({ name, description, hint, extra }) {\n  return (\n    <p style={{ fontSize: \"16px\" }}>\n      <b>{name}</b> {hint && <span style={{ fontSize: \"14px\" }}>{hint}</span>} {extra}\n      {description && <React.Fragment>\n        <br />\n        <span style={{\n          marginTop: 4,\n          fontSize: \"14px\"\n        }}>{description}</span>\n      </React.Fragment>}\n    </p>\n  )\n}","import React from 'react'\nimport { CheckOutlined } from '@ant-design/icons';\nimport { Modal, Table, Button } from 'antd';\nimport './db-selector.css'\nimport { useHistory } from 'react-router-dom';\nimport { useParams } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport { dbIcons } from '../../utils';\nimport { getDbConfigs } from '../../operations/database';\n\nfunction DbSelector(props) {\n  const { projectID, selectedDB } = useParams();\n  const history = useHistory();\n  const dbConfigs = useSelector(state => getDbConfigs(state))\n\n  const dbList = Object.entries(dbConfigs).map(([alias, obj]) => {\n    if (!obj.type) obj.type = alias\n    return { alias: alias, type: obj.type, name: obj.name, setSvgIcon: dbIcons(alias) }\n  })\n\n  const dbcolumns = [\n    {\n      title: '',\n      dataIndex: 'selected',\n      key: 'selected',\n      render: (_, record) => {\n        return (\n          <div>\n            {record.alias === selectedDB && <CheckOutlined className=\"checked\" />}\n          </div>\n        );\n      },\n\n      onCell: (record, _) => {\n        return {\n          selected: record.type\n        };\n      }\n    },\n    {\n      title: 'Alias',\n      dataIndex: 'alias',\n      key: 'alias'\n    },\n    {\n      title: 'DB type',\n      dataIndex: 'type',\n      key: 'type',\n      render: (text, record) => {\n        return (\n          <div>\n            <img src={record.setSvgIcon} alt={record.type} style={{ marginRight: 10 }} />\n            {text}\n          </div>\n        );\n      }\n    },\n    {\n      title: 'DB / Schema name',\n      dataIndex: 'name',\n      key: 'name'\n    },\n  ];\n\n  return (\n    <div>\n      <Modal\n        className=\"select-database\"\n        title={<div className=\"modal-header\">\n          <h2 className=\"modal-title\">Select a database</h2>\n          <Button onClick={() => history.push(`/mission-control/projects/${projectID}/database/add-db`)}>Add Database</Button>\n        </div>}\n        footer={null}\n        closable={false}\n        bodyStyle={{ width: \"800\" }}\n        visible={props.visible}\n        onCancel={props.handleCancel}\n        width={700}\n      >\n        <Table\n          pagination={false}\n          columns={dbcolumns}\n          dataSource={dbList}\n          size=\"middle\"\n\n          onRow={(record) => {\n            return {\n              style: { cursor: \"pointer\" },\n              onClick: () => {\n                {\n                  props.handleSelect(record.alias)\n                  props.handleCancel()\n                }\n              }\n            };\n          }}\n        />\n      </Modal>\n    </div>\n  )\n}\n\nexport default DbSelector","import React from 'react'\nimport { useSelector } from 'react-redux'\nimport { useParams, useHistory } from \"react-router-dom\";\nimport { openProject } from \"../../utils\"\n\nimport { CheckOutlined } from '@ant-design/icons';\n\nimport { Modal, Button, Table } from 'antd';\nimport './select-project.css'\n\nfunction SelectProject({ visible, handleCancel }) {\n  const { projectID } = useParams();\n  const history = useHistory()\n  const projects = useSelector(state => state.projects.map(({ id, name }) => Object.assign({ id, name, selected: id === projectID })))\n  const columns = [\n    {\n      title: '',\n      dataIndex: 'selected',\n      key: 'selected',\n      render: (_, record) => {\n        return (\n          <div>\n            {record.selected && <CheckOutlined className=\"checked\" />}\n          </div>\n        );\n      },\n\n      onCell: (record, _) => {\n        return {\n          selected: record.selected\n        };\n      }\n    },\n    { title: 'Project Name', dataIndex: 'name', key: 'projectName' },\n    { title: 'ID', dataIndex: 'id', key: 'id' }\n  ];\n\n  return (\n    <div >\n      <Modal className=\"select-project\" footer={null} closable={false} bodyStyle={{ widtht: \"800\" }}\n        title={<div className=\"modal-header\">\n          <h2 className=\"modal-title\">Select a project</h2>\n          <Button onClick={() => history.push(\"/mission-control/create-project\")}>Create a project</Button>\n        </div>}\n        visible={visible}\n        onCancel={handleCancel}\n        width={700}\n      >\n        <Table\n          pagination={false}\n          columns={columns}\n          size=\"middle\"\n          dataSource={projects}\n\n          onRow={(record) => {\n            return {\n              style: { cursor: \"pointer\" },\n              onClick: () => {\n                if (!record.selected) {\n                  openProject(record.id)\n                  handleCancel()\n                }\n              }\n            };\n          }}\n        />\n      </Modal>\n    </div>\n  )\n}\n\nexport default SelectProject;\n\n","import React, { useState } from 'react'\nimport { useParams, useHistory } from \"react-router-dom\"\nimport { useSelector } from 'react-redux';\nimport { dbIcons, openBillingPortal } from '../../utils'\nimport { CaretDownOutlined, MenuOutlined, PoweroffOutlined } from '@ant-design/icons';\nimport { Button, Menu, Popover, Row, Col, Tooltip } from 'antd';\nimport DbSelector from '../../components/db-selector/DbSelector'\nimport SelectProject from '../../components/select-project/SelectProject'\nimport './topbar.css'\nimport store from \"../../store\"\nimport { set } from \"automate-redux\"\nimport githubIcon from \"../../assets/githubIcon.svg\"\nimport heartIcon from \"../../assets/heartIcon.svg\"\nimport githubOctocat from \"../../assets/githubOctocat.svg\"\nimport twitterIcon from \"../../assets/twitterIcon.svg\"\nimport logo from '../../assets/logo-black.svg';\nimport upLogo from '../../logo.png';\nimport crownSvg from \"../../assets/crown.svg\";\nimport { isClusterUpgraded, isProdMode } from '../../operations/cluster';\nimport { redirectToLogin, setLastUsedValues } from '../../utils';\n\nconst Topbar = (props) => {\n  const history = useHistory()\n  const { projectID, selectedDB } = useParams()\n  const [modalVisible, setModalVisible] = useState(false)\n  const [visible, setVisible] = useState(false)\n  const state = useSelector(state => state)\n  const projects = useSelector(state => state.projects)\n  const clusterUpgraded = useSelector(state => isClusterUpgraded(state))\n  const selectedProject = projects.find(project => project.id === projectID)\n  const projectName = selectedProject ? selectedProject.name : \"\"\n  const handleDBSelect = (dbName) => {\n    setLastUsedValues(projectID, { db: dbName });\n    history.push(`/mission-control/projects/${projectID}/database/${dbName}`)\n  }\n  const svgIcon = dbIcons(selectedDB)\n  const content = (\n    <div className=\"popContent\">\n      <p style={{ marginBottom: \"50px\", fontWeight: \"bold\", fontSize: \"16px\" }}>Love Space Cloud? Help us spread the love!</p>\n      <Row align=\"middle\">\n        <Col md={{ span: 12, offset: 0 }} >\n          <a href=\"https://github.com/spaceuptech/space-cloud\" target=\"_blank\">\n            <img src={githubOctocat} />\n            <p style={{ marginTop: \"20px\", color: \"rgba(0, 0, 0, 0.65)\", fontWeight: \"600\", fontSize: \"14px\" }}>Star</p>\n          </a>\n        </Col>\n        <Col md={{ span: 12, offset: 0 }}>\n          <a href=\" https://twitter.com/intent/tweet?text=Just%20deployed%20%23SpaceCloud%20-%20an%20opensource%20Firebase%20%2B%20Heroku!%20by%20%40SpaceUpTech.%0Ahttps%3A//github.com/spaceuptech/space-cloud%0A%23graphql%20%23webdev\"\n            target=\"_blank\">\n            <img src={twitterIcon} />\n            <p style={{ marginTop: \"20px\", color: \"rgba(0, 0, 0, 0.65)\", fontWeight: \"600\", fontSize: \"14px\" }}>Tweet</p>\n          </a>\n        </Col>\n      </Row>\n    </div>\n  );\n\n  const onLogoutIconClick = () => {\n    localStorage.removeItem('token');\n    redirectToLogin();\n  }\n  return (\n    <div>\n      <div className=\"topbar\">\n        <MenuOutlined\n          className=\"hamburger\"\n          onClick={() => store.dispatch(set(\"uiState.showSidenav\", true))} />\n        <img className=\"logo\" src={logo} alt=\"logo\" />\n        <img className=\"upLogo\" src={upLogo} alt=\"logo\" />\n        {props.showProjectSelector && <div className=\"btn-position\">\n          <Button className=\"action-rounded\" onClick={() => setModalVisible(true)}>{projectName}\n            <CaretDownOutlined />\n          </Button>\n        </div>}\n        {props.showDbSelector && <div className=\"db-btn-position\">\n          <Button className=\"action-rounded\" onClick={() => setVisible(true)}>\n            <img src={svgIcon} alt={selectedDB} style={{ marginRight: 10 }} />\n            {selectedDB}\n            <CaretDownOutlined />\n          </Button>\n        </div>}\n        <DbSelector visible={visible} handleSelect={handleDBSelect} handleCancel={() => setVisible(false)} />\n        <SelectProject visible={modalVisible} handleCancel={() => setModalVisible(false)} />\n        <div className=\"right-list\">\n          <Menu mode=\"horizontal\">\n            <Menu.Item>\n              <a href=\"https://docs.spaceuptech.com/\" target=\"_blank\">Docs</a>\n            </Menu.Item>\n            <Menu.Item>\n              <a href=\"https://learn.spaceuptech.com/\" target=\"_blank\">Learn</a>\n            </Menu.Item>\n            <Menu.Item>\n              <a href=\"https://github.com/spaceuptech/space-cloud\" target=\"_blank\">\n                <img src={githubIcon} />\n              </a>\n            </Menu.Item>\n            <Menu.Item>\n              <Popover content={content} trigger=\"click\" placement=\"bottomRight\" overlayStyle={{ textAlign: \"center\" }}>\n                <img src={heartIcon} />\n              </Popover>\n            </Menu.Item>\n            {isProdMode(state) && (\n              <Menu.Item>\n                <Tooltip title=\"Logout\">\n                  <PoweroffOutlined style={{ fontSize: 24, verticalAlign: 'middle', color: 'rgba(0, 0, 0, 0.54)' }} onClick={onLogoutIconClick} />\n                </Tooltip>\n              </Menu.Item>\n            )}\n          </Menu>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Topbar;","import React from \"react\";\nimport { Form } from \"antd\";\n\nexport default function ConditionalFormBlock({ dependency, condition, children, shouldUpdate }) {\n  if (!shouldUpdate) shouldUpdate = (prev, curr) => prev[dependency] !== curr[dependency]\n  return <Form.Item noStyle shouldUpdate={shouldUpdate}>\n    {() => {\n      return (\n        <React.Fragment>\n          {condition() && children}\n        </React.Fragment>\n      )\n    }}\n  </Form.Item>\n}","import { set } from \"automate-redux\";\nimport { get } from \"dot-prop-immutable\";\nimport client from \"../client\";\nimport store from \"../store\";\n\nexport const saveCacheConfig = (config) => {\n\treturn new Promise((resolve, reject) => {\n\t\tclient.cache.setCacheConfig(config)\n\t\t\t.then(({ queued }) => {\n\t\t\t\tif (!queued) {\n\t\t\t\t\tstore.dispatch(setCacheConfig(config))\n\t\t\t\t\tif (config.enabled) {\n\t\t\t\t\t\tloadCacheConnState()\n\t\t\t\t\t\t\t.catch(error => reject(error))\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tresolve({ queued })\n\t\t\t})\n\t\t\t.catch(error => reject(error))\n\t})\n}\n\nexport const loadCacheConfig = () => {\n\treturn new Promise((resolve, reject) => {\n\t\tclient.cache.getCacheConfig()\n\t\t\t.then(result => {\n\t\t\t\tlet cacheConfig = result[0]\n\t\t\t\tif (!cacheConfig) cacheConfig = {}\n\t\t\t\tstore.dispatch(setCacheConfig(cacheConfig))\n\t\t\t\tresolve()\n\t\t\t})\n\t\t\t.catch((error) => reject(error))\n\t})\n}\n\nexport const loadCacheConnState = () => {\n\treturn new Promise((resolve, reject) => {\n\t\tclient.cache.getCacheConnStatus()\n\t\t\t.then(result => {\n\t\t\t\tstore.dispatch(setCacheConnState(result))\n\t\t\t\tresolve()\n\t\t\t})\n\t\t\t.catch(error => reject(error))\n\t})\n}\n\nexport const purgeCache = (projectId) => {\n\treturn new Promise((resolve, reject) => {\n\t\tconst purgeOptions = {\n\t\t\tresource: \"*\",\n\t\t\tdbAlias: \"*\",\n\t\t\tid: \"*\"\n\t\t}\n\n\t\tclient.cache.purgeCache(projectId, purgeOptions)\n\t\t\t.then(() => resolve())\n\t\t\t.catch(error => reject(error))\n\t})\n}\n\n// Getters\nexport const getCacheConfig = (state) => get(state, \"cacheConfig\", {})\nexport const getCacheConnState = (state) => get(state, \"cacheConnState\", false)\n\n// Setters\nconst setCacheConfig = (config) => set(\"cacheConfig\", config)\nconst setCacheConnState = (connected) => set(\"cacheConnState\", connected)","import React, { useEffect, useState } from \"react\";\nimport { Controlled as CodeMirror } from 'react-codemirror2';\nimport 'codemirror/theme/material.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/mode/javascript/javascript';\nimport 'codemirror/mode/go/go';\nimport 'codemirror/addon/selection/active-line.js';\nimport 'codemirror/addon/edit/matchbrackets.js';\nimport 'codemirror/addon/edit/closebrackets.js';\nimport 'codemirror/addon/lint/json-lint.js';\nimport 'codemirror/addon/lint/lint.js';\n\nfunction JSONCodeMirror(props) {\n  const [value, setValue] = useState(props.value ? props.value : '')\n\n  const handleChangeValue = (value) => {\n    setValue(value)\n    props.onChange(value)\n  }\n  return (\n    <div style={props.style ? props.style : undefined}>\n      <CodeMirror\n        value={value}\n        options={{\n          mode: { name: \"javascript\", json: true },\n          lineNumbers: true,\n          styleActiveLine: true,\n          matchBrackets: true,\n          autoCloseBrackets: true,\n          tabSize: 2,\n          gutters: [],\n          lint: value ? true : false,\n          ...props.options\n        }}\n        onBeforeChange={(editor, data, value) => {\n          handleChangeValue(value);\n        }}\n      />\n    </div>\n  )\n}\n\nexport default JSONCodeMirror;","module.exports = \"data:image/svg+xml,%3Csvg width='170' height='35' viewBox='0 0 170 35' fill='none' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E %3Crect width='169.75' height='35' fill='url(%23pattern0)'/%3E %3Cdefs%3E %3Cpattern id='pattern0' patternContentUnits='objectBoundingBox' width='1' height='1'%3E %3Cuse xlink:href='%23image0' transform='translate(-0.0128205) scale(0.00528681 0.025641)'/%3E %3C/pattern%3E %3Cimage id='image0' width='194' height='39' xlink:href='data:image/png;base64,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'/%3E %3C/defs%3E %3C/svg%3E\"","import React, { useState, useEffect } from 'react';\nimport { AutoComplete } from 'antd';\nimport dotProp from 'dot-prop-immutable';\n\nconst ObjectAutoComplete = (props) => {\n  const { options } = props;\n  const [value, setValue] = useState(props.value ? props.value : \"\");\n\n  const getFilteredOptions = () => {\n    const variables = value.split(\".\");\n    const path = variables.slice(0, variables.length - 1);\n\n    return dotProp.get(options, path.join(\".\")) ? Object.keys(dotProp.get(options, path.join(\".\"))) : Object.keys(options);\n  }\n\n  const filteredOptions = getFilteredOptions();\n\n  const handleSearch = (val) => {\n    setValue(val);\n    props.onChange(val);\n  }\n\n  const handleSelect = (val) => {\n    setValue(value.substring(0, value.lastIndexOf(\".\") + 1) + val); // Before last dot\n    props.onChange(value.substring(0, value.lastIndexOf(\".\") + 1) + val);\n  }\n  return (\n    <AutoComplete\n      placeholder={props.placeholder}\n      onSearch={handleSearch}\n      onSelect={handleSelect}\n      value={value}\n      style={props.style}\n    >\n      {filteredOptions\n        .filter(\n          (data) =>\n            data.toLowerCase().indexOf(value.substring(value.lastIndexOf(\".\") + 1).toLowerCase()) !== -1 // After last dot\n        )\n        .map((data) => (\n          <AutoComplete.Option key={data} value={data}>\n            {data}\n          </AutoComplete.Option>\n        ))}\n    </AutoComplete>\n  )\n}\n\nexport default ObjectAutoComplete;","module.exports = \"data:image/svg+xml,%3Csvg width='31' height='30' viewBox='0 0 31 30' fill='none' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='M15.461 0.520508C7.0246 0.520508 0.183594 7.28259 0.183594 15.6243C0.183594 22.2976 4.56103 27.9592 10.6312 29.9563C11.3947 30.0961 11.6751 29.6287 11.6751 29.2297C11.6751 28.8696 11.6608 27.6797 11.6544 26.4177C7.40407 27.3313 6.50723 24.6356 6.50723 24.6356C5.81229 22.8898 4.81097 22.4257 4.81097 22.4257C3.42491 21.4882 4.91545 21.5074 4.91545 21.5074C6.4496 21.614 7.25741 23.0639 7.25741 23.0639C8.61998 25.373 10.8313 24.7054 11.7031 24.3196C11.8402 23.3433 12.2362 22.6771 12.6731 22.2999C9.27982 21.9179 5.7126 20.6228 5.7126 14.8355C5.7126 13.1866 6.30941 11.8391 7.28677 10.7814C7.12813 10.401 6.60524 8.86481 7.43474 6.78436C7.43474 6.78436 8.71763 6.37841 11.6371 8.33259C12.8557 7.99783 14.1626 7.8301 15.461 7.82441C16.7593 7.8301 18.0673 7.99783 19.2882 8.33259C22.2042 6.37841 23.4853 6.78436 23.4853 6.78436C24.3169 8.86481 23.7937 10.401 23.6351 10.7814C24.6146 11.8391 25.2074 13.1865 25.2074 14.8355C25.2074 20.6365 21.6334 21.914 18.2315 22.2878C18.7795 22.7565 19.2677 23.6758 19.2677 25.0848C19.2677 27.1057 19.25 28.7322 19.25 29.2297C19.25 29.6316 19.525 30.1026 20.2995 29.9543C26.3664 27.9549 30.7383 22.2954 30.7383 15.6243C30.7383 7.28259 23.8982 0.520508 15.461 0.520508Z' fill='%23161614'/%3E %3Cpath d='M5.90528 22.0364C5.87173 22.1114 5.75215 22.1339 5.64348 22.0825C5.53264 22.0332 5.47034 21.9308 5.50628 21.8555C5.53923 21.7783 5.65881 21.7567 5.7694 21.8086C5.88047 21.8578 5.94374 21.9611 5.90528 22.0364ZM6.65677 22.6993C6.58392 22.7661 6.44146 22.7351 6.34477 22.6295C6.24484 22.5242 6.22615 22.3835 6.30007 22.3156C6.3752 22.2489 6.51335 22.2801 6.61352 22.3855C6.71344 22.492 6.73285 22.6319 6.65665 22.6994L6.65677 22.6993ZM7.17234 23.5474C7.07865 23.6117 6.92552 23.5514 6.83098 23.4171C6.73741 23.2829 6.73741 23.1218 6.83302 23.0573C6.92792 22.9927 7.07865 23.0507 7.1745 23.184C7.26796 23.3206 7.26796 23.4817 7.17222 23.5475L7.17234 23.5474ZM8.04414 24.5298C7.96038 24.621 7.78209 24.5966 7.65149 24.472C7.51802 24.3502 7.48075 24.1774 7.56475 24.086C7.64946 23.9946 7.82882 24.0203 7.96038 24.1439C8.09302 24.2654 8.13352 24.4395 8.04426 24.5298H8.04414ZM9.1709 24.8615C9.13411 24.9797 8.96229 25.0335 8.78928 24.9832C8.6165 24.9315 8.5034 24.7929 8.53826 24.6734C8.57421 24.5543 8.74674 24.4983 8.92108 24.5521C9.09362 24.6036 9.20696 24.7411 9.17102 24.8615H9.1709ZM10.4534 25.0021C10.4577 25.1267 10.311 25.23 10.1293 25.2322C9.94659 25.2361 9.79886 25.1353 9.79694 25.0128C9.79694 24.887 9.94036 24.7847 10.123 24.7817C10.3046 24.7782 10.4534 24.8783 10.4534 25.0021ZM11.7132 24.9543C11.735 25.0759 11.6087 25.2007 11.4284 25.2339C11.251 25.2659 11.0869 25.1909 11.0642 25.0704C11.0422 24.9458 11.1709 24.8211 11.3479 24.7887C11.5285 24.7577 11.6902 24.8308 11.7132 24.9543Z' fill='%23161614'/%3E %3C/svg%3E\"","import { generateId } from \"./utils\";\nimport gql from \"graphql-tag\";\nimport gqlPrettier from 'graphql-prettier';\nimport { format } from 'prettier-package-json';\nimport { LoremIpsum } from \"lorem-ipsum\";\nimport dotprop from \"dot-prop-immutable\";\n\nconst lorem = new LoremIpsum();\n\nconst primitiveTypes = [\"ID\", \"String\", \"Float\", \"Integer\", \"Boolean\", \"Date\", \"Time\", \"DateTime\", \"JSON\", \"SmallInteger\", \"BigInteger\", \"Decimal\", \"Char\", \"Varchar\", \"DateTimeWithZone\"]\nconst getDefType = (type, isArray, required) => {\n  isArray = isArray ? true : type.kind === \"ListType\";\n  required = required ? true : type.kind === \"NonNullType\";\n  if (type.type) {\n    return getDefType(type.type, isArray, required);\n  }\n  return { isArray, fieldType: type.name.value, required };\n};\n\nconst generateSchemaASTFromGraphQLSchemaDefinition = (def) => {\n  const { isArray, fieldType, required } = getDefType(def.type);\n  const directives = def.directives;\n  const isPrimary = directives.some((dir) => dir.name.value === \"primary\");\n  const isLink = directives.some((dir) => dir.name.value === \"link\");\n  const hasForeignConstraint = directives.some((dir) => dir.name.value === \"foreign\");\n  const hasUniqueConstraint = directives.some((dir) => dir.name.value === \"unique\");\n  const hasNestedFields = !primitiveTypes.includes(fieldType)\n  const hasCreatedAtDirective = directives.some((dir) => dir.name.value === \"createdAt\");\n  const hasUpdatedAtDirective = directives.some((dir) => dir.name.value === \"updatedAt\");\n  let foreignTable = null, foreignField = null;\n  if (hasForeignConstraint) {\n    const foreignDirective = directives.find(\n      (dir) => dir.name.value === \"foreign\"\n    );\n    const tableArgument = foreignDirective.arguments.find(\n      (ar) => ar.name.value === \"table\"\n    );\n    const fieldArgument = foreignDirective.arguments.find(\n      (ar) => ar.name.value === \"field\" || ar.name.value === \"to\"\n    );\n    foreignTable = tableArgument.value.value;\n    foreignField = fieldArgument.value.value;\n  }\n  let linkTable = null, linkFrom = null, linkTo = null, linkDb = null;\n  if (isLink) {\n    const linkDirective = directives.find((dir) => dir.name.value === \"link\");\n    const tableArgument = linkDirective.arguments.find(\n      (ar) => ar.name.value === \"table\"\n    );\n    const fromArgument = linkDirective.arguments.find(\n      (ar) => ar.name.value === \"from\"\n    );\n    const toArgument = linkDirective.arguments.find(\n      (ar) => ar.name.value === \"to\"\n    );\n    const dbArgument = linkDirective.arguments.find(\n      (ar) => ar.name.value === \"db\"\n    );\n    linkTable = tableArgument ? tableArgument.value.value : undefined;\n    linkFrom = fromArgument ? fromArgument.value.value : undefined;\n    linkTo = toArgument ? toArgument.value.value : undefined;\n    linkDb = dbArgument ? dbArgument.value.value : undefined;\n  }\n  return {\n    name: def.name.value,\n    type: fieldType,\n    isArray: isArray,\n    isRequired: required,\n    isPrimary: isPrimary,\n    hasNestedFields: hasNestedFields,\n    hasUniqueConstraint: hasUniqueConstraint,\n    hasForeignConstraint: hasForeignConstraint,\n    foreign: hasForeignConstraint ? {\n      table: foreignTable,\n      field: foreignField,\n    } : undefined,\n    isLink: isLink,\n    link: isLink ? {\n      table: linkTable,\n      from: linkFrom,\n      to: linkTo,\n      db: linkDb\n    } : undefined,\n    hasCreatedAtDirective,\n    hasUpdatedAtDirective\n  };\n};\n\nexport const generateSchemaAST = (schemaString) => {\n  if (!schemaString) return {}\n  const definitions = gql(schemaString).definitions.filter(\n    (obj) => obj.kind === \"ObjectTypeDefinition\"\n  );\n  const schemaAST = definitions.reduce((prev, def) => {\n    return Object.assign(prev, {\n      [def.name.value]: def.fields\n        .filter(def => def.kind === \"FieldDefinition\")\n        .map(obj => generateSchemaASTFromGraphQLSchemaDefinition(obj))\n    })\n  }, {});\n  return schemaAST;\n};\n\nconst generateGraphQLArgsString = (args = []) => {\n  if (args.length === 0) {\n    return \"\"\n  }\n  const argsKeyValuePairs = args.map(arg => `${arg.name}: ${JSON.stringify(arg.value)}`)\n  return `(${argsKeyValuePairs.join(\",\")})`\n}\n\n// Generates a graphql string for a field along with its arguments and directives\nconst generateFieldQuery = (field) => {\n  const { name, args, directives = [], fields = [] } = field\n  const directivesString = directives.length === 0 ? \"\" : \" \" + directives.map(obj => `@${obj.name}${generateGraphQLArgsString(obj.args)}`).join(\" \")\n  let fieldString = `${name}${generateGraphQLArgsString(args)}${directivesString}`\n  if (fields.length > 0) {\n    fieldString = fieldString + `{\n      ${fields.map(field => generateFieldQuery(field)).join(\"\\n\")}\n    }`\n  }\n  return fieldString\n}\n\n// Removes all redundant commas and quotes from the GraphQL string\nconst removeRegex = (value, dataresponse) => {\n  let removeOpeningComma = /\\,(?=\\s*?[\\{\\]])/g;\n  let removeClosingComma = /\\,(?=\\s*?[\\}\\]])/g;\n  let removeQuotes = /\"([^\"]+)\"/g;\n  value = value.replace(removeOpeningComma, '');\n  value = value.replace(removeClosingComma, '');\n  if (dataresponse) value = format(JSON.parse(value))\n  else value = value.replace(removeQuotes, '$1')\n  return value\n}\n\nexport const generateGraphQLQueryFromGraphQLAST = (ast = { queryType: \"query\", fields: [] }) => {\n  const query = `${ast.queryType} {\n    ${ast.fields.map(field => generateFieldQuery(field)).join(\"\\n\")}\n  }`\n\n  let result = gqlPrettier(removeRegex(query, 0))\n  if (ast.queryType === \"query\") {\n    result = \"query \" + result\n  }\n\n  return result\n}\n\nexport const generateSchemaASTs = (schemas) => {\n  const schemaASTs = Object.entries(schemas).reduce((prev, curr) => {\n    const [dbName, dbSchema] = curr\n    const schemaAST = Object.values(dbSchema).reduce((prev, curr) => {\n      if (!curr) {\n        return prev\n      }\n      return Object.assign({}, prev, generateSchemaAST(curr))\n    }, {})\n    return Object.assign({}, prev, { [dbName]: schemaAST })\n  }, {})\n\n  return schemaASTs\n}\n\nconst generateRandomValue = (type) => {\n  if (process.env.NODE_ENV === \"test\") {\n    switch (type) {\n      case \"ID\":\n        return \"0ujsszwN8NRY24YaXiTIE2VWDTS\"\n      case \"String\":\n        return \"lorem ipsum\"\n      case \"Integer\":\n        return 25\n      case \"Float\":\n        return 4.5\n      case \"Boolean\":\n        return true\n      case \"Date\":\n        return \"2017-11-13\"\n      case \"Time\":\n        return \"03:15:45.108\"\n      case \"DateTime\":\n        return \"2017-11-13T03:15:45.108Z\"\n      case \"JSON\":\n        return { foo: \"bar\" }\n      case \"SmallInteger\":\n        return 12\n      case \"BigInteger\":\n        return 4323\n      case \"Decimal\":\n        return 23.84\n      case \"Char\":\n        return \"F919mV2W1ifQy9wlNyYnoOoqUM1\"\n      case \"Varchar\":\n        return \"7mr8VjGnCCerZUyzC9YDCn8Oxku\"\n      case \"DateTimeWithZone\":\n        return \"2021-11-22T03:15:45.108\"\n      default:\n        return type\n    }\n  } else {\n    switch (type) {\n      case \"ID\":\n        return generateId(6)\n      case \"String\":\n        return lorem.generateWords(2)\n      case \"Integer\":\n        return Math.ceil(Math.random() * 100)\n      case \"Float\":\n        return Number((Math.random() * 100).toFixed(2))\n      case \"Boolean\":\n        return true\n      case \"Date\":\n        return new Date().toISOString().split(\"T\")[0]\n      case \"Time\":\n        return new Date().toISOString().split(\"T\")[1].slice(0, -1)\n      case \"DateTime\":\n        return new Date().toISOString()\n      case \"JSON\":\n        return { foo: \"bar\" }\n      case \"SmallInteger\":\n        return Math.ceil(Math.random() * 100)\n      case \"BigInteger\":\n        return Math.ceil(Math.random() * 10000)\n      case \"Decimal\":\n        return Number((Math.random() * 100).toFixed(2))\n      case \"Char\":\n        return generateId(6)\n      case \"Varchar\":\n        return generateId(6)\n      case \"DateTimeWithZone\":\n        return new Date().toISOString()\n      default:\n        return type\n    }\n  }\n}\n\nexport const generateRandomFieldValues = (fields = []) => {\n  return fields.reduce((prev, { name, type, isArray, hasNestedFields, fields }) => {\n    if (hasNestedFields) {\n      const value = generateRandomFieldValues(fields)\n      return Object.assign({}, prev, {\n        [name]: isArray ? [value] : value\n      })\n    }\n    const value = generateRandomValue(type)\n    return Object.assign({}, prev, {\n      [name]: isArray ? [value] : value\n    })\n  }, {})\n}\n\n// Gets the primary fields. If no primary fields are present then it returns the unique fields.\nconst getPrimaryOrUniqueFields = (fields = []) => {\n  const primaryFields = fields.filter(field => field.isPrimary)\n  if (primaryFields.length > 0) {\n    return primaryFields\n  }\n  return fields.filter(field => field.hasUniqueConstraint)\n}\n\nconst generateWhereClause = (fields) => {\n  const primaryFields = getPrimaryOrUniqueFields(fields)\n  const clause = primaryFields.reduce((prev, { name, type }) => {\n    return Object.assign({}, prev, {\n      [name]: type === \"JSON\" ? { _contains: `$${name}` } : { _eq: `$${name}` }\n    })\n  }, {})\n  const params = generateRandomFieldValues(primaryFields)\n  return { clause, params }\n}\n\nconst getSchemaAST = (schemaASTs, dbName, schemaName) => {\n  if (schemaASTs[dbName] && schemaASTs[dbName][schemaName]) {\n    return schemaASTs[dbName][schemaName]\n  }\n  return []\n}\n\nexport const generateSampleQueryDBDelete = (schemaASTs, schemaName, dbAliasName, applyFilters) => {\n  let variables = {}\n  let whereClause = {}\n  let args = []\n  const fields = getSchemaAST(schemaASTs, dbAliasName, schemaName)\n  if (applyFilters) {\n    const res = generateWhereClause(fields)\n    whereClause = res.clause\n    variables = res.params\n    args.push({\n      name: \"where\",\n      value: whereClause\n    })\n  }\n\n  const graphQLRequestAST = {\n    queryType: \"mutation\",\n    fields: [\n      {\n        name: `delete_${schemaName}`,\n        directives: [{ name: dbAliasName }],\n        args: args,\n        fields: [{ name: \"status\" }, { name: \"error\" }]\n      }\n    ]\n  }\n  const query = generateGraphQLQueryFromGraphQLAST(graphQLRequestAST)\n  const response = {\n    data: {\n      [`delete_${schemaName}`]: {\n        status: 200\n      }\n    }\n  }\n  return { query, variables, response }\n}\n\nconst getInsertFields = (schemaASTs, dbName, schemaName, parentSchemaName, getAutoGeneratedFields, schemasTraversed = {}) => {\n  schemasTraversed = dotprop.set(schemasTraversed, `${dbName}.${schemaName}`, true)\n  const fields = getSchemaAST(schemaASTs, dbName, schemaName)\n  const insertableFields = fields.filter(field => {\n    // Skip inserting a field in linked object if it can be auto filled from parent table because of foreign key \n    if (!getAutoGeneratedFields && parentSchemaName && field.hasForeignConstraint && field.foreign.table === parentSchemaName) {\n      return false\n    }\n\n    // Skip inserting a field if it can be auto filled from child table because of link\n    if (!getAutoGeneratedFields && !field.isPrimary && fields.some(obj => obj.link && obj.link.from === field.name)) {\n      return false\n    }\n\n    // Skip inserting a linked field if it can't be auto inserted\n    if (field.isLink) {\n      if (!field.hasNestedFields) {\n        return false\n      }\n\n      const adjustedDbName = field.link && field.link.db ? field.link.db : dbName\n      if (dotprop.get(schemasTraversed, `${adjustedDbName}.${field.type}`)) {\n        return false\n      }\n    }\n\n    // Skip inserting a field with createdAt and updatedAt directive\n    if (!getAutoGeneratedFields && (field.hasCreatedAtDirective || field.hasUpdatedAtDirective)) {\n      return false\n    }\n\n    return true\n  })\n\n  // Fill in the linked fields in the insertable fields \n  const finalFields = insertableFields.map(field => {\n    if (field.isLink) {\n      const adjustedDbName = field.link && field.link.db ? field.link.db : dbName\n      return {\n        name: field.name,\n        hasNestedFields: true,\n        fields: getInsertFields(schemaASTs, adjustedDbName, field.link.table, schemaName, getAutoGeneratedFields, schemasTraversed),\n        isArray: field.isArray\n      }\n    }\n\n    return {\n      name: field.name,\n      type: field.type,\n      isArray: field.isArray\n    }\n  })\n\n  return finalFields\n}\n\nexport const generateSampleQueryDBInsert = (schemaASTs, schemaName, dbAliasName) => {\n  const fieldsToBeInserted = getInsertFields(schemaASTs, dbAliasName, schemaName, undefined, false)\n  const insertedFields = getInsertFields(schemaASTs, dbAliasName, schemaName, undefined, true)\n  const docs = [generateRandomFieldValues(fieldsToBeInserted)]\n  const insertedFieldValues = [generateRandomFieldValues(insertedFields)]\n  const variables = { docs }\n  const graphQLRequestAST = {\n    queryType: \"mutation\",\n    fields: [\n      {\n        name: `insert_${schemaName}`,\n        directives: [{ name: dbAliasName }],\n        args: [{ name: \"docs\", value: \"$docs\" }],\n        fields: [{ name: \"status\" }, { name: \"error\" }, { name: \"returning\" }]\n      }\n    ]\n  }\n  const query = generateGraphQLQueryFromGraphQLAST(graphQLRequestAST)\n  const response = {\n    data: {\n      [`insert_${schemaName}`]: {\n        status: 200,\n        returning: insertedFieldValues\n      }\n    }\n  }\n  return { query, variables, response }\n}\n\nconst getReadFields = (schemaASTs, dbName, schemaName, schemasTraversed = {}) => {\n  const fields = getSchemaAST(schemaASTs, dbName, schemaName)\n  schemasTraversed = dotprop.set(schemasTraversed, `${dbName}.${schemaName}`, true)\n  // Fill in the linked fields\n  const finalFields = fields.filter(field => {\n    const adjustedDbName = field.link && field.link.db ? field.link.db : dbName\n    return !(field.hasNestedFields && dotprop.get(schemasTraversed, `${adjustedDbName}.${field.type}`, false))\n  })\n    .map(field => {\n      if (field.hasNestedFields) {\n        const adjustedDbName = field.link && field.link.db ? field.link.db : dbName\n        return {\n          name: field.name,\n          hasNestedFields: true,\n          fields: getReadFields(schemaASTs, adjustedDbName, field.type, schemasTraversed),\n          isArray: field.isArray\n        }\n      }\n\n      return {\n        name: field.name,\n        type: field.type,\n        isArray: field.isArray\n      }\n    })\n\n  return finalFields\n}\n\nexport const generateSampleQueryDBRead = (schemaASTs, schemaName, dbAliasName, applyFilters, sort, skip, limit) => {\n  let variables = {}\n  let whereClause = {}\n  let args = []\n  const fields = getSchemaAST(schemaASTs, dbAliasName, schemaName)\n\n  if (applyFilters) {\n    const res = generateWhereClause(fields)\n    whereClause = res.clause\n    variables = Object.assign(variables, res.params)\n    args.push({\n      name: \"where\",\n      value: whereClause\n    })\n  }\n\n  if (sort) {\n    const sortWeight = {\n      ID: 0,\n      Integer: 1,\n      Float: 2,\n      Date: 3,\n      Time: 4,\n      DateTime: 5\n    }\n    const sortFields = fields.filter(field => !field.isPrimary && [\"ID\", \"Integer\", \"Float\", \"Date\", \"Time\", \"DateTime\"].includes(field.type) && !field.isArray)\n      .sort((a, b) => sortWeight[a.type] - sortWeight[b.type])\n      .slice(0, 2)\n      .map(field => field.name)\n    variables = Object.assign(variables, { sort: sortFields })\n    args.push({\n      name: \"sort\",\n      value: \"$sort\"\n    })\n  }\n\n  if (skip) {\n    variables = Object.assign(variables, { skip: 20 })\n    args.push({\n      name: \"skip\",\n      value: \"$skip\"\n    })\n  }\n\n  if (limit) {\n    variables = Object.assign(variables, { limit: 10 })\n    args.push({\n      name: \"limit\",\n      value: \"$limit\"\n    })\n  }\n\n  const selectionSet = getReadFields(schemaASTs, dbAliasName, schemaName)\n  const selectionSetValue = [generateRandomFieldValues(selectionSet)]\n\n  const graphQLRequestAST = {\n    queryType: \"query\",\n    fields: [\n      {\n        name: schemaName,\n        directives: [{ name: dbAliasName }],\n        args: args,\n        fields: selectionSet\n      }\n    ]\n  }\n  const query = generateGraphQLQueryFromGraphQLAST(graphQLRequestAST)\n  const response = {\n    data: {\n      [schemaName]: selectionSetValue\n    }\n  }\n  return { query, variables, response }\n}\n\nexport const generateSampleQueryDBUpdate = (schemaASTs, schemaName, dbAliasName, applyFilters, upsert) => {\n  let variables = {}\n  let whereClause = {}\n  let args = []\n  const fields = getSchemaAST(schemaASTs, dbAliasName, schemaName)\n\n  if (applyFilters) {\n    const res = generateWhereClause(fields)\n    whereClause = res.clause\n    variables = Object.assign(variables, res.params)\n    args.push({\n      name: \"where\",\n      value: whereClause\n    })\n  }\n\n  args.push({\n    name: \"set\",\n    value: \"$set\"\n  })\n\n  if (upsert) {\n    args.push({\n      name: \"op\",\n      value: \"upsert\"\n    })\n  }\n\n  const graphQLRequestAST = {\n    queryType: \"mutation\",\n    fields: [\n      {\n        name: `update_${schemaName}`,\n        directives: [{ name: dbAliasName }],\n        args: args,\n        fields: [{ name: \"status\" }, { name: \"error\" }]\n      }\n    ]\n  }\n\n  const setFields = fields.filter(field => primitiveTypes.includes(field.type) && !field.hasUpdatedAtDirective && !field.hasCreatedAtDirective\n    && !field.hasForeignConstraint && !field.isPrimary && !field.hasUniqueConstraint)\n  const setFieldsValue = generateRandomFieldValues(setFields)\n  variables = Object.assign(variables, { set: setFieldsValue })\n\n  const query = generateGraphQLQueryFromGraphQLAST(graphQLRequestAST)\n  const response = {\n    data: {\n      [`update_${schemaName}`]: {\n        status: 200\n      }\n    }\n  }\n  return { query, variables, response }\n}","import React, { useState } from \"react\";\nimport { Controlled as CodeMirror } from 'react-codemirror2';\nimport 'codemirror/theme/material.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/mode/javascript/javascript';\nimport 'codemirror/mode/go/go';\nimport 'codemirror/addon/selection/active-line.js';\nimport 'codemirror/addon/edit/matchbrackets.js';\nimport 'codemirror/addon/edit/closebrackets.js';\n\nfunction AntCodeMirror(props) {\n  const [value, setValue] = useState(props.value ? props.value : '')\n\n  const handleChangeValue = (value) => {\n    setValue(value)\n    props.onChange(value)\n  }\n  return (\n    <div style={props.style ? props.style : undefined}I>\n      <CodeMirror\n        value={value}\n        options={props.options}\n        onBeforeChange={(editor, data, value) => {\n          handleChangeValue(value);\n        }}\n      />\n    </div>\n  )\n}\n\nexport default AntCodeMirror;","module.exports = \"data:image/svg+xml,%3Csvg width='34' height='32' viewBox='0 0 34 32' fill='none' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='M17.0002 31.2916L14.5835 29.0916C6.00016 21.3083 0.333496 16.1749 0.333496 9.87492C0.333496 4.74159 4.36683 0.708252 9.50016 0.708252C12.4002 0.708252 15.1835 2.05825 17.0002 4.19159C18.8168 2.05825 21.6002 0.708252 24.5002 0.708252C29.6335 0.708252 33.6668 4.74159 33.6668 9.87492C33.6668 16.1749 28.0002 21.3083 19.4168 29.1083L17.0002 31.2916Z' fill='%23FF3C24'/%3E %3C/svg%3E\"","module.exports = __webpack_public_path__ + \"4b79f11a2f2ed18c9294bd72befce407.svg\";","module.exports = \"data:image/svg+xml,%3C!-- Generator: Adobe Illustrator 19.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0) --%3E %3Csvg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='90' height='100' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'%3E %3Cpath style='fill:%2303A9F4;' d='M512,97.248c-19.04,8.352-39.328,13.888-60.48,16.576c21.76-12.992,38.368-33.408,46.176-58.016 c-20.288,12.096-42.688,20.64-66.56,25.408C411.872,60.704,384.416,48,354.464,48c-58.112,0-104.896,47.168-104.896,104.992 c0,8.32,0.704,16.32,2.432,23.936c-87.264-4.256-164.48-46.08-216.352-109.792c-9.056,15.712-14.368,33.696-14.368,53.056 c0,36.352,18.72,68.576,46.624,87.232c-16.864-0.32-33.408-5.216-47.424-12.928c0,0.32,0,0.736,0,1.152 c0,51.008,36.384,93.376,84.096,103.136c-8.544,2.336-17.856,3.456-27.52,3.456c-6.72,0-13.504-0.384-19.872-1.792 c13.6,41.568,52.192,72.128,98.08,73.12c-35.712,27.936-81.056,44.768-130.144,44.768c-8.608,0-16.864-0.384-25.12-1.44 C46.496,446.88,101.6,464,161.024,464c193.152,0,298.752-160,298.752-298.688c0-4.64-0.16-9.12-0.384-13.568 C480.224,136.96,497.728,118.496,512,97.248z'/%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3C/svg%3E\"","module.exports = \"data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E %3Cg clip-path='url(%23clip0)'%3E %3Cpath d='M14.01 4.50799L14.01 4.50793C13.7681 4.16492 13.7922 3.84078 13.9282 3.60033C14.0739 3.34283 14.3556 3.16673 14.6667 3.16673C15.1265 3.16673 15.5 3.54021 15.5 4.00007C15.5 4.33543 15.305 4.62367 15.0286 4.75105C14.674 4.91395 14.4623 5.17838 14.3396 5.4627C14.3398 5.46 14.3399 5.45729 14.34 5.45459C14.3526 5.12204 14.2244 4.81222 14.01 4.50799ZM14.0453 6.24245C14.099 6.16314 14.1541 6.07478 14.2019 5.97698C14.1679 6.21871 14.1667 6.45792 14.1667 6.65273V10.8334H1.83333V6.65273C1.83333 6.45798 1.83215 6.21893 1.79809 5.97734C1.84597 6.07487 1.90108 6.16297 1.95486 6.24205C2.515 7.06799 3.38683 7.8334 4.66667 7.8334C6.69029 7.8334 7.70902 6.15563 7.91462 4.84558L7.91479 4.84451L7.91628 4.83485C7.94603 4.64274 7.98577 4.3861 7.93758 4.11997C7.88381 3.82303 7.73341 3.56149 7.47863 3.31366L7.47816 3.3132C7.27726 3.1183 7.16667 2.89744 7.16667 2.66673C7.16667 2.20687 7.54014 1.8334 8 1.8334C8.45986 1.8334 8.83333 2.20687 8.83333 2.66673C8.83333 2.89744 8.72274 3.1183 8.52184 3.3132L8.52137 3.31366C8.26676 3.56132 8.11613 3.82276 8.06221 4.11975C8.01366 4.38713 8.05395 4.64467 8.08413 4.83761L8.08533 4.8453L8.08538 4.84558C8.29098 6.15563 9.30971 7.8334 11.3333 7.8334C12.6131 7.8334 13.4849 7.06803 14.045 6.24288L14.0453 6.24245ZM1.65983 5.46172C1.53706 5.17795 1.32558 4.91419 0.971847 4.75125L0.971729 4.7512C0.695159 4.6239 0.5 4.33557 0.5 4.00007C0.5 3.54021 0.873479 3.16673 1.33333 3.16673C1.64438 3.16673 1.92614 3.34283 2.07181 3.60033C2.20783 3.84078 2.23189 4.16492 1.99003 4.50793C1.7754 4.81195 1.64686 5.12182 1.65953 5.45452C1.65962 5.45692 1.65972 5.45933 1.65983 5.46172ZM14.1667 13.1667V14.1667H1.83333V13.1667H14.1667Z' stroke='%23FF6700'/%3E %3C/g%3E %3Cdefs%3E %3CclipPath id='clip0'%3E %3Crect width='16' height='16' fill='white'/%3E %3C/clipPath%3E %3C/defs%3E %3C/svg%3E\""],"sourceRoot":""}